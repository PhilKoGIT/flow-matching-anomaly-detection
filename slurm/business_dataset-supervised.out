== Job start ==
================================================================================
LOADING & PREPARING BUSINESS TRANSACTION DATA
================================================================================
✓ preprocessed_full_dataset.csv saved to data/

Shapes nach Preprocessing:
  X_train: (24712, 12)
  X_test : (6232, 12)
  y_train: (24712,), Anomalien = 0 (0.00%)
  y_test : (6232,), Anomalien = 54 (0.87%)

Feature matrix shapes (nach Drop von bank_account_uuid):
  X_train: (24712, 11)
  X_test : (6232, 11)

Test-Label-Verteilung (0=normal, 1=anomaly):
  Normal : 6178 (99.13%)
  Anomaly: 54 (0.87%)

================================================================================
TRAIN of FORESTDIFFUSION MODEL ON FULL TRAINING DATA
================================================================================
✓ Model trained successfully on full training data!

================================================================================
COMPUTING ANOMALY SCORES AUF TESTSET
================================================================================
✓ Anomaly scores computed: 6232
  Score range: [2.5885, 34.5928]
  Score mean : 5.9299
  Score std  : 2.4666

================================================================================
EVALUATION METRICS
================================================================================

✓ ROC-AUC Score: 0.8509

Performance at different threshold percentiles:
--------------------------------------------------------------------------------

90th Percentile (threshold=8.1119):
  Precision: 0.0545 | Recall: 0.6296 | F1: 0.1003 | Acc: 0.9021
  Confusion Matrix: TP=34, FP=590, TN=5588, FN=20

95th Percentile (threshold=9.7748):
  Precision: 0.0929 | Recall: 0.5370 | F1: 0.1585 | Acc: 0.9506
  Confusion Matrix: TP=29, FP=283, TN=5895, FN=25

97.5th Percentile (threshold=11.9032):
  Precision: 0.1410 | Recall: 0.4074 | F1: 0.2095 | Acc: 0.9734
  Confusion Matrix: TP=22, FP=134, TN=6044, FN=32

99th Percentile (threshold=16.4501):
  Precision: 0.2063 | Recall: 0.2407 | F1: 0.2222 | Acc: 0.9854
  Confusion Matrix: TP=13, FP=50, TN=6128, FN=41

99.5th Percentile (threshold=20.4013):
  Precision: 0.2500 | Recall: 0.1481 | F1: 0.1860 | Acc: 0.9888
  Confusion Matrix: TP=8, FP=24, TN=6154, FN=46

99.9th Percentile (threshold=27.0033):
  Precision: 0.4286 | Recall: 0.0556 | F1: 0.0984 | Acc: 0.9912
  Confusion Matrix: TP=3, FP=4, TN=6174, FN=51

✓ Best F1-Score: 0.2222 at 99th percentile (threshold=16.4501)

Final confusion matrix at best F1 threshold:
[[6128   50]
 [  41   13]]
  Normal correctly classified: 6128/6178
  Anomalies detected          : 13/54

================================================================================
CREATING VISUALIZATIONS
================================================================================
✓ Saved plot to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_detection_results.png

================================================================================
SAVING RESULTS
================================================================================

Top highest anomaly scores:
      test_index  original_index  is_anomaly  anomaly_score  \
4974        4974            5980           0      34.592814   
6220        6220            1368           1      32.882549   
5765        5765           13313           0      32.590317   
4013        4013           20696           0      30.674988   
6229        6229           29504           1      28.974291   
6032        6032           27566           0      27.473985   
6230        6230           15284           1      27.029992   
6223        6223           14762           1      26.914460   
4647        4647           12201           0      26.407196   
6080        6080            9303           0      25.384578   
6231        6231            5560           1      25.210287   
6226        6226            7471           1      24.984022   
5908        5908           18091           0      24.550421   
5197        5197           27802           0      24.479654   
3757        3757           22540           0      23.875745   
5482        5482            4738           0      23.520936   
5297        5297           29038           0      23.406502   
2885        2885           30384           0      23.379111   
5232        5232            5831           0      23.375954   
2879        2879            4818           0      23.295941   
4946        4946           16817           0      23.094604   
4349        4349           19117           0      23.005842   
1785        1785           12866           0      22.536163   
4316        4316           12522           0      21.640727   
4632        4632           12789           0      21.458805   
1645        1645           30554           0      21.429030   
5821        5821           18283           0      21.083222   
3880        3880           15001           0      20.915941   
6222        6222           21630           1      20.854117   
5552        5552           18065           0      20.794098   
1211        1211           20075           0      20.617128   
6225        6225            8430           1      20.439961   
1365        1365           10873           0      20.190671   
4751        4751           22420           0      20.109698   
615          615             489           0      19.741498   
6197        6197            1113           1      19.455793   
5901        5901           24321           0      19.437011   
5625        5625           29099           0      19.233021   
3231        3231           14636           0      19.105384   
1012        1012            4488           0      19.018554   
1038        1038            6582           0      18.960611   
6026        6026           23139           0      18.853391   
5499        5499           19398           0      18.286003   
2059        2059           30050           0      18.159014   
1471        1471           20500           0      18.105927   
5753        5753           19109           0      18.081204   
3611        3611            2823           0      17.936313   
2692        2692           24569           0      17.843248   
4486        4486           27757           0      17.786301   
318          318           15485           0      17.638210   
721          721           22463           0      17.527883   
1915        1915            9499           0      17.452236   
2065        2065            5424           0      17.440452   
6212        6212            2968           1      17.436766   
6211        6211            5634           1      17.322127   
4186        4186            7215           0      17.180577   
6228        6228           21742           1      16.887450   
2331        2331            3970           0      16.864144   
4415        4415           12444           0      16.747137   
4648        4648             461           0      16.654062   
4128        4128            1621           0      16.581413   
581          581           11181           0      16.538730   
6192        6192           16079           1      16.478733   
4793        4793           24981           0      16.386310   
6079        6079           10569           0      16.345362   
5858        5858            5388           0      16.308500   
6203        6203           14469           1      16.288746   
5095        5095           11353           0      16.281765   
2181        2181            4281           0      16.272323   
3325        3325           21306           0      16.136307   
206          206           19402           0      16.048354   
4448        4448           19745           0      15.931196   
4813        4813            3297           0      15.908007   
5223        5223           10635           0      15.845707   
6187        6187           27580           1      15.773498   
6190        6190           10314           1      15.751492   
6207        6207           19600           1      15.565342   
3216        3216           20121           0      15.562595   
5298        5298           22858           0      15.436143   
4034        4034           23668           0      15.365687   
4718        4718           19440           0      15.238186   
441          441            4725           0      15.140928   
4172        4172           27164           0      14.927684   
909          909           22752           0      14.903391   
2306        2306           10271           0      14.860296   
5049        5049            2886           0      14.809355   
6191        6191           22518           1      14.685387   
1847        1847           20991           0      14.658054   
5117        5117            4723           0      14.554942   
2737        2737           16836           0      14.538196   
2469        2469           24820           0      14.419448   
3479        3479            2052           0      14.417886   
1881        1881            2343           0      14.347067   
5331        5331            8372           0      14.346449   
6084        6084           10266           0      14.255181   
4109        4109           26217           0      14.196230   
3480        3480           22102           0      14.048063   
3851        3851           21138           0      14.046132   
1367        1367            2646           0      13.931036   
2453        2453           24937           0      13.907583   
3756        3756           25477           0      13.868188   
5308        5308            6869           0      13.858709   
4335        4335           16590           0      13.853423   
4434        4434            4220           0      13.805706   
4903        4903           11415           0      13.742240   
3862        3862           29840           0      13.721614   
5713        5713            2389           0      13.704290   
6189        6189           25492           1      13.693814   
3474        3474           22872           0      13.647603   
3918        3918           25201           0      13.425799   
3578        3578           18151           0      13.416719   
2598        2598           21767           0      13.400713   
3755        3755           17585           0      13.383889   
4716        4716           24731           0      13.337155   
4309        4309           18846           0      13.230393   
5463        5463           23223           0      13.227116   
4033        4033             414           0      13.132660   
3167        3167           13150           0      13.120632   
4101        4101            9567           0      13.093453   
2706        2706           19218           0      13.059299   
5714        5714           21605           0      13.054206   
4113        4113           23059           0      13.013136   
6213        6213           21270           1      12.981371   
2593        2593           26685           0      12.962289   
2763        2763           12008           0      12.940484   
3307        3307            4771           0      12.903517   
5612        5612           15119           0      12.856602   
5309        5309           26756           0      12.830793   
3051        3051            7048           0      12.825960   
5229        5229           28386           0      12.795516   
4959        4959           29809           0      12.790552   
2928        2928            2180           0      12.777905   
3036        3036            6448           0      12.719578   
6185        6185            5103           1      12.690306   
5479        5479           26818           0      12.680311   
3713        3713           26680           0      12.677700   
6090        6090           23400           0      12.638100   
5346        5346           28960           0      12.556014   
5306        5306           11909           0      12.444847   
4741        4741            1132           0      12.427147   
4753        4753           13771           0      12.373469   
3028        3028            7396           0      12.359965   
3222        3222           26392           0      12.340992   
4435        4435            8635           0      12.265266   
1289        1289           12974           0      12.231425   
2147        2147           16990           0      12.138829   
3572        3572           22997           0      12.110905   
1766        1766           15817           0      12.071290   
3579        3579           24237           0      12.038482   
681          681           28078           0      12.032462   
2276        2276            3876           0      12.019366   
6217        6217           20583           1      11.987529   
2563        2563           25972           0      11.972105   
5576        5576            8119           0      11.956802   
5460        5460           19142           0      11.929752   
3352        3352           20099           0      11.917565   
5570        5570            8798           0      11.899068   
6216        6216            9362           1      11.872710   
5982        5982           30196           0      11.871534   
5837        5837           29914           0      11.858141   
5574        5574           28206           0      11.854903   
5434        5434            1933           0      11.850133   
5563        5563            8007           0      11.777309   
5853        5853           18379           0      11.766981   
4276        4276            3775           0      11.766424   
6178        6178           25614           1      11.760370   
4596        4596           11057           0      11.758982   
5819        5819            8060           0      11.750245   
2609        2609            7778           0      11.748067   
6087        6087           30435           0      11.728833   
4782        4782           14309           0      11.673780   
4125        4125           12498           0      11.673106   
5589        5589           13912           0      11.638401   
904          904           30176           0      11.595489   
732          732           25942           0      11.584622   
5039        5039             282           0      11.575706   
5550        5550           14784           0      11.558122   
5041        5041           11189           0      11.555937   
5023        5023           23537           0      11.540101   
2849        2849           24309           0      11.535330   
4445        4445            2991           0      11.516986   
5814        5814           30705           0      11.516107   
5827        5827           16337           0      11.508782   
3853        3853             272           0      11.483333   
6179        6179           12414           1      11.477925   
2122        2122           24739           0      11.462534   
5012        5012            7553           0      11.433450   
1486        1486           16304           0      11.422238   
6091        6091           11789           0      11.415506   
5818        5818            4611           0      11.407120   
4594        4594           29085           0      11.383818   
5958        5958             311           0      11.348386   
5173        5173           10678           0      11.341724   
5502        5502           19208           0      11.332325   
4742        4742           22641           0      11.315919   
4768        4768            6778           0      11.304247   
6188        6188           22673           1      11.280574   
4439        4439           13859           0      11.170280   
1294        1294           19576           0      11.170067   
5212        5212           12155           0      11.155680   
2715        2715           12443           0      11.150976   
2431        2431           30637           0      11.144176   
5051        5051            1370           0      11.126463   
2110        2110            4640           0      11.098710   
5091        5091             355           0      11.091014   
5179        5179            7880           0      11.086592   
2144        2144            3837           0      11.060591   
5599        5599           27905           0      11.047531   
3575        3575           27501           0      11.045407   
1931        1931           18649           0      10.966727   
1314        1314           29024           0      10.958284   
1773        1773            7217           0      10.939501   
1859        1859           18605           0      10.939194   
5902        5902            1162           0      10.932016   
1288        1288           22819           0      10.926148   
4429        4429           17336           0      10.878532   
2711        2711            2898           0      10.862349   
3432        3432           20424           0      10.840094   
6083        6083           22854           0      10.814189   
6210        6210           14947           1      10.784732   
3551        3551            8640           0      10.784454   
6227        6227             733           1      10.778581   
2010        2010           21896           0      10.759235   
5862        5862           23261           0      10.752517   
6204        6204            5007           1      10.729598   
2307        2307           29748           0      10.729217   
6089        6089           26450           0      10.719186   
1758        1758           11933           0      10.691102   
4918        4918           29100           0      10.668625   
3559        3559           29229           0      10.659301   
2869        2869            6158           0      10.641769   
3852        3852           20631           0      10.607584   
2005        2005            8040           0      10.604552   
5296        5296           22907           0      10.603723   
2998        2998             760           0      10.598841   
5726        5726           18408           0      10.579488   
5055        5055            1912           0      10.577224   
3589        3589           11538           0      10.574331   
2988        2988           16266           0      10.569705   
3577        3577            1855           0      10.553081   
5715        5715           19905           0      10.538123   
5034        5034           14686           0      10.515071   
3781        3781           27746           0      10.495062   
5030        5030           15973           0      10.480041   
2271        2271           21732           0      10.469280   
1672        1672            7920           0      10.447564   
3165        3165            3879           0      10.404461   
5857        5857            6447           0      10.380747   
2881        2881           21146           0      10.380507   
2574        2574           10769           0      10.378406   
3919        3919           25293           0      10.376990   
4426        4426           26986           0      10.371113   
5793        5793           10680           0      10.353813   
4127        4127           15671           0      10.350337   
4313        4313            9477           0      10.336919   
5293        5293            8897           0      10.327812   
1615        1615            5169           0      10.319898   
5891        5891           16305           0      10.309113   
4507        4507           24627           0      10.292530   
3557        3557           17812           0      10.292025   
4148        4148             561           0      10.288908   
1176        1176           13130           0      10.288007   
3732        3732           18285           0      10.281552   
5375        5375            7320           0      10.278461   
5147        5147            9980           0      10.265629   
1006        1006            5143           0      10.238834   
5314        5314           17464           0      10.232939   
3992        3992            3473           0      10.223602   
5854        5854            8088           0      10.216517   
3560        3560           29987           0      10.166986   
4140        4140           17260           0      10.146424   
719          719           12812           0      10.142073   
5562        5562             271           0      10.139721   
2267        2267             364           0      10.126678   
2996        2996           23017           0      10.121135   
426          426           11693           0      10.101310   
2978        2978            2872           0      10.086798   
5028        5028           16446           0      10.079567   
2412        2412           18751           0      10.070570   
2707        2707            6630           0      10.064842   
6085        6085           11976           0      10.061157   
5281        5281           26041           0      10.045163   
3311        3311            2308           0      10.043062   
3582        3582           29632           0      10.028283   
1283        1283           26531           0      10.026944   
2979        2979            2454           0      10.024825   
419          419            9173           0      10.020131   
2423        2423           22940           0      10.018298   
5551        5551           10408           0      10.015401   
3313        3313           15568           0      10.003579   
3318        3318            8063           0      10.001655   
2006        2006            7997           0       9.983280   
5646        5646           18648           0       9.953413   
4662        4662            4265           0       9.927790   
5276        5276           12142           0       9.911003   
4498        4498           18070           0       9.908015   
1884        1884           23384           0       9.905677   
3323        3323           25101           0       9.904401   
4733        4733           16129           0       9.901807   
2401        2401           10881           0       9.895214   
5299        5299           11190           0       9.876758   
52            52            7694           0       9.871884   
5557        5557           19806           0       9.868585   
5307        5307           24220           0       9.850114   
4424        4424           30885           0       9.818690   
3304        3304           29868           0       9.818379   
3319        3319           13735           0       9.815157   
4221        4221            3351           0       9.807408   
4422        4422           20230           0       9.793595   
1844        1844            7989           0       9.788227   
1730        1730           18221           0       9.775649   
2132        2132           16713           0       9.775501   
3841        3841           12271           0       9.774186   
914          914           21609           0       9.760526   
3047        3047           25143           0       9.744820   
4410        4410           23267           0       9.743498   
3840        3840           25444           0       9.737179   
5554        5554           16085           0       9.732274   
1528        1528            8540           0       9.726856   
3023        3023            3883           0       9.717366   
1579        1579           14698           0       9.716617   
5549        5549            3383           0       9.715265   
2406        2406           25206           0       9.713074   
2573        2573            2790           0       9.707580   
3494        3494           24307           0       9.686281   
5300        5300           12386           0       9.670914   
3905        3905            6995           0       9.657843   
5302        5302            5324           0       9.650527   
667          667            4602           0       9.641598   
6002        6002            3555           0       9.634087   
5295        5295           18668           0       9.624887   
6184        6184           10124           1       9.605192   
3486        3486            4772           0       9.605101   
5283        5283           15080           0       9.588365   
1591        1591            4992           0       9.587505   
5285        5285            3048           0       9.585971   
3554        3554           10620           0       9.584853   
4048        4048           30122           0       9.584118   
2166        2166           19503           0       9.583511   
6076        6076            9494           0       9.575709   
3314        3314            9100           0       9.567002   
5027        5027           13474           0       9.566375   
5553        5553           24544           0       9.555347   
413          413           12381           0       9.554381   
3299        3299           17638           0       9.554336   
5706        5706           24273           0       9.538314   
4416        4416            9449           0       9.530303   
4734        4734           15532           0       9.523906   
2134        2134           28788           0       9.520315   
4947        4947            9443           0       9.519662   
5455        5455           27532           0       9.515465   
693          693           25476           0       9.513788   
5556        5556            6595           0       9.503722   
4727        4727           29034           0       9.501108   
4743        4743           10449           0       9.500715   
5291        5291           11131           0       9.487337   
5775        5775           14985           0       9.483099   
4722        4722           27904           0       9.479570   
5305        5305           22309           0       9.467961   
5280        5280           21600           0       9.458933   
4413        4413           19911           0       9.457650   
5008        5008           16265           0       9.440337   
4737        4737            3826           0       9.440041   
2748        2748           23370           0       9.432505   
993          993           18593           0       9.413042   
5217        5217           19017           0       9.411412   
972          972           30377           0       9.410963   
1016        1016           11332           0       9.401629   
3847        3847           26355           0       9.399669   
5303        5303           19210           0       9.398513   
4420        4420           21255           0       9.395944   
3292        3292           29045           0       9.395163   
5561        5561           22983           0       9.383819   
994          994           24928           0       9.380016   
3331        3331           24878           0       9.377958   
4717        4717           27086           0       9.377115   
5301        5301            2291           0       9.374289   
5345        5345           10233           0       9.371638   
5294        5294            5458           0       9.369082   
5548        5548           22154           0       9.368508   
3999        3999            6551           0       9.360977   
1597        1597           12632           0       9.356423   
4710        4710           16083           0       9.348646   
4902        4902            5287           0       9.343590   
2704        2704           28696           0       9.338396   
4728        4728            2192           0       9.336723   
1039        1039           22118           0       9.324785   
4730        4730            6097           0       9.320695   
3601        3601           16635           0       9.317029   
5855        5855           14551           0       9.298683   
4739        4739            8392           0       9.292794   
2534        2534           13924           0       9.281390   
2611        2611           18867           0       9.279406   
5558        5558           23586           0       9.275688   
5429        5429           26178           0       9.261440   
5174        5174           24797           0       9.253321   
3227        3227            1181           0       9.248113   
4783        4783           24417           0       9.236237   
6081        6081           25122           0       9.235185   
1011        1011            3800           0       9.233440   

      predicted_anomaly  \
4974                  1   
6220                  1   
5765                  1   
4013                  1   
6229                  1   
6032                  1   
6230                  1   
6223                  1   
4647                  1   
6080                  1   
6231                  1   
6226                  1   
5908                  1   
5197                  1   
3757                  1   
5482                  1   
5297                  1   
2885                  1   
5232                  1   
2879                  1   
4946                  1   
4349                  1   
1785                  1   
4316                  1   
4632                  1   
1645                  1   
5821                  1   
3880                  1   
6222                  1   
5552                  1   
1211                  1   
6225                  1   
1365                  1   
4751                  1   
615                   1   
6197                  1   
5901                  1   
5625                  1   
3231                  1   
1012                  1   
1038                  1   
6026                  1   
5499                  1   
2059                  1   
1471                  1   
5753                  1   
3611                  1   
2692                  1   
4486                  1   
318                   1   
721                   1   
1915                  1   
2065                  1   
6212                  1   
6211                  1   
4186                  1   
6228                  1   
2331                  1   
4415                  1   
4648                  1   
4128                  1   
581                   1   
6192                  1   
4793                  0   
6079                  0   
5858                  0   
6203                  0   
5095                  0   
2181                  0   
3325                  0   
206                   0   
4448                  0   
4813                  0   
5223                  0   
6187                  0   
6190                  0   
6207                  0   
3216                  0   
5298                  0   
4034                  0   
4718                  0   
441                   0   
4172                  0   
909                   0   
2306                  0   
5049                  0   
6191                  0   
1847                  0   
5117                  0   
2737                  0   
2469                  0   
3479                  0   
1881                  0   
5331                  0   
6084                  0   
4109                  0   
3480                  0   
3851                  0   
1367                  0   
2453                  0   
3756                  0   
5308                  0   
4335                  0   
4434                  0   
4903                  0   
3862                  0   
5713                  0   
6189                  0   
3474                  0   
3918                  0   
3578                  0   
2598                  0   
3755                  0   
4716                  0   
4309                  0   
5463                  0   
4033                  0   
3167                  0   
4101                  0   
2706                  0   
5714                  0   
4113                  0   
6213                  0   
2593                  0   
2763                  0   
3307                  0   
5612                  0   
5309                  0   
3051                  0   
5229                  0   
4959                  0   
2928                  0   
3036                  0   
6185                  0   
5479                  0   
3713                  0   
6090                  0   
5346                  0   
5306                  0   
4741                  0   
4753                  0   
3028                  0   
3222                  0   
4435                  0   
1289                  0   
2147                  0   
3572                  0   
1766                  0   
3579                  0   
681                   0   
2276                  0   
6217                  0   
2563                  0   
5576                  0   
5460                  0   
3352                  0   
5570                  0   
6216                  0   
5982                  0   
5837                  0   
5574                  0   
5434                  0   
5563                  0   
5853                  0   
4276                  0   
6178                  0   
4596                  0   
5819                  0   
2609                  0   
6087                  0   
4782                  0   
4125                  0   
5589                  0   
904                   0   
732                   0   
5039                  0   
5550                  0   
5041                  0   
5023                  0   
2849                  0   
4445                  0   
5814                  0   
5827                  0   
3853                  0   
6179                  0   
2122                  0   
5012                  0   
1486                  0   
6091                  0   
5818                  0   
4594                  0   
5958                  0   
5173                  0   
5502                  0   
4742                  0   
4768                  0   
6188                  0   
4439                  0   
1294                  0   
5212                  0   
2715                  0   
2431                  0   
5051                  0   
2110                  0   
5091                  0   
5179                  0   
2144                  0   
5599                  0   
3575                  0   
1931                  0   
1314                  0   
1773                  0   
1859                  0   
5902                  0   
1288                  0   
4429                  0   
2711                  0   
3432                  0   
6083                  0   
6210                  0   
3551                  0   
6227                  0   
2010                  0   
5862                  0   
6204                  0   
2307                  0   
6089                  0   
1758                  0   
4918                  0   
3559                  0   
2869                  0   
3852                  0   
2005                  0   
5296                  0   
2998                  0   
5726                  0   
5055                  0   
3589                  0   
2988                  0   
3577                  0   
5715                  0   
5034                  0   
3781                  0   
5030                  0   
2271                  0   
1672                  0   
3165                  0   
5857                  0   
2881                  0   
2574                  0   
3919                  0   
4426                  0   
5793                  0   
4127                  0   
4313                  0   
5293                  0   
1615                  0   
5891                  0   
4507                  0   
3557                  0   
4148                  0   
1176                  0   
3732                  0   
5375                  0   
5147                  0   
1006                  0   
5314                  0   
3992                  0   
5854                  0   
3560                  0   
4140                  0   
719                   0   
5562                  0   
2267                  0   
2996                  0   
426                   0   
2978                  0   
5028                  0   
2412                  0   
2707                  0   
6085                  0   
5281                  0   
3311                  0   
3582                  0   
1283                  0   
2979                  0   
419                   0   
2423                  0   
5551                  0   
3313                  0   
3318                  0   
2006                  0   
5646                  0   
4662                  0   
5276                  0   
4498                  0   
1884                  0   
3323                  0   
4733                  0   
2401                  0   
5299                  0   
52                    0   
5557                  0   
5307                  0   
4424                  0   
3304                  0   
3319                  0   
4221                  0   
4422                  0   
1844                  0   
1730                  0   
2132                  0   
3841                  0   
914                   0   
3047                  0   
4410                  0   
3840                  0   
5554                  0   
1528                  0   
3023                  0   
1579                  0   
5549                  0   
2406                  0   
2573                  0   
3494                  0   
5300                  0   
3905                  0   
5302                  0   
667                   0   
6002                  0   
5295                  0   
6184                  0   
3486                  0   
5283                  0   
1591                  0   
5285                  0   
3554                  0   
4048                  0   
2166                  0   
6076                  0   
3314                  0   
5027                  0   
5553                  0   
413                   0   
3299                  0   
5706                  0   
4416                  0   
4734                  0   
2134                  0   
4947                  0   
5455                  0   
693                   0   
5556                  0   
4727                  0   
4743                  0   
5291                  0   
5775                  0   
4722                  0   
5305                  0   
5280                  0   
4413                  0   
5008                  0   
4737                  0   
2748                  0   
993                   0   
5217                  0   
972                   0   
1016                  0   
3847                  0   
5303                  0   
4420                  0   
3292                  0   
5561                  0   
994                   0   
3331                  0   
4717                  0   
5301                  0   
5345                  0   
5294                  0   
5548                  0   
3999                  0   
1597                  0   
4710                  0   
4902                  0   
2704                  0   
4728                  0   
1039                  0   
4730                  0   
3601                  0   
5855                  0   
4739                  0   
2534                  0   
2611                  0   
5558                  0   
5429                  0   
5174                  0   
3227                  0   
4783                  0   
6081                  0   
1011                  0   

                                                                                 anomaly_description  
4974                                                                                             NaN  
6220  SUBTLE_PAYEE_MISMATCH: Payee changed from 'Valentine LLC Solutions' to 'Valentine LLC Systems'  
5765                                                                                             NaN  
4013                                                                                             NaN  
6229      SUBTLE_PAYEE_MISMATCH: Payee changed from 'Ramirez PLC Solutions' to 'Ramirez PLC Systems'  
6032                                                                                             NaN  
6230                         IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB35VJGS13...  
6223          SUBTLE_PAYEE_MISMATCH: Payee changed from 'Jones PLC Solutions' to 'Jones PLC Systems'  
4647                                                                                             NaN  
6080                                                                                             NaN  
6231                                                     AMOUNT_ANOMALY: Amount changed from ~708309  
6226                         IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB80JWGI98...  
5908                                                                                             NaN  
5197                                                                                             NaN  
3757                                                                                             NaN  
5482                                                                                             NaN  
5297                                                                                             NaN  
2885                                                                                             NaN  
5232                                                                                             NaN  
2879                                                                                             NaN  
4946                                                                                             NaN  
4349                                                                                             NaN  
1785                                                                                             NaN  
4316                                                                                             NaN  
4632                                                                                             NaN  
1645                                                                                             NaN  
5821                                                                                             NaN  
3880                                                                                             NaN  
6222                            CHANNEL_ANOMALY: Payment made via CARD/MOBILE_APP instead of ACH/API  
5552                                                                                             NaN  
1211                                                                                             NaN  
6225                                     PAYEE_ANOMALY: Payee changed from Barton-Anderson Solutions  
1365                                                                                             NaN  
4751                                                                                             NaN  
615                                                                                              NaN  
6197    SUBTLE_PAYEE_MISMATCH: Payee changed from 'Holloway Ltd Solutions' to 'Holloway Ltd Systems'  
5901                                                                                             NaN  
5625                                                                                             NaN  
3231                                                                                             NaN  
1012                                                                                             NaN  
1038                                                                                             NaN  
6026                                                                                             NaN  
5499                                                                                             NaN  
2059                                                                                             NaN  
1471                                                                                             NaN  
5753                                                                                             NaN  
3611                                                                                             NaN  
2692                                                                                             NaN  
4486                                                                                             NaN  
318                                                                                              NaN  
721                                                                                              NaN  
1915                                                                                             NaN  
2065                                                                                             NaN  
6212                         IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB08ZDRX90...  
6211    SUBTLE_PAYEE_MISMATCH: Payee changed from 'Holloway Ltd Solutions' to 'Holloway Ltd Systems'  
4186                                                                                             NaN  
6228                                                    FREQUENCY_ANOMALY: Duplicate monthly payment  
2331                                                                                             NaN  
4415                                                                                             NaN  
4648                                                                                             NaN  
4128                                                                                             NaN  
581                                                                                              NaN  
6192                         IBAN_MISMATCH_ANOMALY: IBAN changed from GB76WGHG50... to GB47WTLI10...  
4793                                                                                             NaN  
6079                                                                                             NaN  
5858                                                                                             NaN  
6203        SUBTLE_PAYEE_MISMATCH: Payee changed from 'Buck-Kelly Solutions' to 'Buck-Kelly Systems'  
5095                                                                                             NaN  
2181                                                                                             NaN  
3325                                                                                             NaN  
206                                                                                              NaN  
4448                                                                                             NaN  
4813                                                                                             NaN  
5223                                                                                             NaN  
6187      SUBTLE_PAYEE_MISMATCH: Payee changed from 'Ramirez PLC Solutions' to 'Ramirez PLC Systems'  
6190                            CHANNEL_ANOMALY: Payment made via CARD/MOBILE_APP instead of ACH/API  
6207  SUBTLE_PAYEE_MISMATCH: Payee changed from 'Valentine LLC Solutions' to 'Valentine LLC Systems'  
3216                                                                                             NaN  
5298                                                                                             NaN  
4034                                                                                             NaN  
4718                                                                                             NaN  
441                                                                                              NaN  
4172                                                                                             NaN  
909                                                                                              NaN  
2306                                                                                             NaN  
5049                                                                                             NaN  
6191                            CHANNEL_ANOMALY: Payment made via CARD/MOBILE_APP instead of ACH/API  
1847                                                                                             NaN  
5117                                                                                             NaN  
2737                                                                                             NaN  
2469                                                                                             NaN  
3479                                                                                             NaN  
1881                                                                                             NaN  
5331                                                                                             NaN  
6084                                                                                             NaN  
4109                                                                                             NaN  
3480                                                                                             NaN  
3851                                                                                             NaN  
1367                                                                                             NaN  
2453                                                                                             NaN  
3756                                                                                             NaN  
5308                                                                                             NaN  
4335                                                                                             NaN  
4434                                                                                             NaN  
4903                                                                                             NaN  
3862                                                                                             NaN  
5713                                                                                             NaN  
6189    SUBTLE_PAYEE_MISMATCH: Payee changed from 'Holloway Ltd Solutions' to 'Holloway Ltd Systems'  
3474                                                                                             NaN  
3918                                                                                             NaN  
3578                                                                                             NaN  
2598                                                                                             NaN  
3755                                                                                             NaN  
4716                                                                                             NaN  
4309                                                                                             NaN  
5463                                                                                             NaN  
4033                                                                                             NaN  
3167                                                                                             NaN  
4101                                                                                             NaN  
2706                                                                                             NaN  
5714                                                                                             NaN  
4113                                                                                             NaN  
6213        SUBTLE_PAYEE_MISMATCH: Payee changed from 'Buck-Kelly Solutions' to 'Buck-Kelly Systems'  
2593                                                                                             NaN  
2763                                                                                             NaN  
3307                                                                                             NaN  
5612                                                                                             NaN  
5309                                                                                             NaN  
3051                                                                                             NaN  
5229                                                                                             NaN  
4959                                                                                             NaN  
2928                                                                                             NaN  
3036                                                                                             NaN  
6185                                     PAYEE_ANOMALY: Payee changed from Barton-Anderson Solutions  
5479                                                                                             NaN  
3713                                                                                             NaN  
6090                                                                                             NaN  
5346                                                                                             NaN  
5306                                                                                             NaN  
4741                                                                                             NaN  
4753                                                                                             NaN  
3028                                                                                             NaN  
3222                                                                                             NaN  
4435                                                                                             NaN  
1289                                                                                             NaN  
2147                                                                                             NaN  
3572                                                                                             NaN  
1766                                                                                             NaN  
3579                                                                                             NaN  
681                                                                                              NaN  
2276                                                                                             NaN  
6217                                                     AMOUNT_ANOMALY: Amount changed from ~240840  
2563                                                                                             NaN  
5576                                                                                             NaN  
5460                                                                                             NaN  
3352                                                                                             NaN  
5570                                                                                             NaN  
6216                                                    FREQUENCY_ANOMALY: Duplicate monthly payment  
5982                                                                                             NaN  
5837                                                                                             NaN  
5574                                                                                             NaN  
5434                                                                                             NaN  
5563                                                                                             NaN  
5853                                                                                             NaN  
4276                                                                                             NaN  
6178          SUBTLE_PAYEE_MISMATCH: Payee changed from 'Jones PLC Solutions' to 'Jones PLC Systems'  
4596                                                                                             NaN  
5819                                                                                             NaN  
2609                                                                                             NaN  
6087                                                                                             NaN  
4782                                                                                             NaN  
4125                                                                                             NaN  
5589                                                                                             NaN  
904                                                                                              NaN  
732                                                                                              NaN  
5039                                                                                             NaN  
5550                                                                                             NaN  
5041                                                                                             NaN  
5023                                                                                             NaN  
2849                                                                                             NaN  
4445                                                                                             NaN  
5814                                                                                             NaN  
5827                                                                                             NaN  
3853                                                                                             NaN  
6179      SUBTLE_PAYEE_MISMATCH: Payee changed from 'Ramirez PLC Solutions' to 'Ramirez PLC Systems'  
2122                                                                                             NaN  
5012                                                                                             NaN  
1486                                                                                             NaN  
6091                                                                                             NaN  
5818                                                                                             NaN  
4594                                                                                             NaN  
5958                                                                                             NaN  
5173                                                                                             NaN  
5502                                                                                             NaN  
4742                                                                                             NaN  
4768                                                                                             NaN  
6188                                           PAYEE_ANOMALY: Payee changed from Allen Ltd Solutions  
4439                                                                                             NaN  
1294                                                                                             NaN  
5212                                                                                             NaN  
2715                                                                                             NaN  
2431                                                                                             NaN  
5051                                                                                             NaN  
2110                                                                                             NaN  
5091                                                                                             NaN  
5179                                                                                             NaN  
2144                                                                                             NaN  
5599                                                                                             NaN  
3575                                                                                             NaN  
1931                                                                                             NaN  
1314                                                                                             NaN  
1773                                                                                             NaN  
1859                                                                                             NaN  
5902                                                                                             NaN  
1288                                                                                             NaN  
4429                                                                                             NaN  
2711                                                                                             NaN  
3432                                                                                             NaN  
6083                                                                                             NaN  
6210                                           PAYEE_ANOMALY: Payee changed from Allen Ltd Solutions  
3551                                                                                             NaN  
6227                                                    FREQUENCY_ANOMALY: Duplicate monthly payment  
2010                                                                                             NaN  
5862                                                                                             NaN  
6204  SUBTLE_PAYEE_MISMATCH: Payee changed from 'Valentine LLC Solutions' to 'Valentine LLC Systems'  
2307                                                                                             NaN  
6089                                                                                             NaN  
1758                                                                                             NaN  
4918                                                                                             NaN  
3559                                                                                             NaN  
2869                                                                                             NaN  
3852                                                                                             NaN  
2005                                                                                             NaN  
5296                                                                                             NaN  
2998                                                                                             NaN  
5726                                                                                             NaN  
5055                                                                                             NaN  
3589                                                                                             NaN  
2988                                                                                             NaN  
3577                                                                                             NaN  
5715                                                                                             NaN  
5034                                                                                             NaN  
3781                                                                                             NaN  
5030                                                                                             NaN  
2271                                                                                             NaN  
1672                                                                                             NaN  
3165                                                                                             NaN  
5857                                                                                             NaN  
2881                                                                                             NaN  
2574                                                                                             NaN  
3919                                                                                             NaN  
4426                                                                                             NaN  
5793                                                                                             NaN  
4127                                                                                             NaN  
4313                                                                                             NaN  
5293                                                                                             NaN  
1615                                                                                             NaN  
5891                                                                                             NaN  
4507                                                                                             NaN  
3557                                                                                             NaN  
4148                                                                                             NaN  
1176                                                                                             NaN  
3732                                                                                             NaN  
5375                                                                                             NaN  
5147                                                                                             NaN  
1006                                                                                             NaN  
5314                                                                                             NaN  
3992                                                                                             NaN  
5854                                                                                             NaN  
3560                                                                                             NaN  
4140                                                                                             NaN  
719                                                                                              NaN  
5562                                                                                             NaN  
2267                                                                                             NaN  
2996                                                                                             NaN  
426                                                                                              NaN  
2978                                                                                             NaN  
5028                                                                                             NaN  
2412                                                                                             NaN  
2707                                                                                             NaN  
6085                                                                                             NaN  
5281                                                                                             NaN  
3311                                                                                             NaN  
3582                                                                                             NaN  
1283                                                                                             NaN  
2979                                                                                             NaN  
419                                                                                              NaN  
2423                                                                                             NaN  
5551                                                                                             NaN  
3313                                                                                             NaN  
3318                                                                                             NaN  
2006                                                                                             NaN  
5646                                                                                             NaN  
4662                                                                                             NaN  
5276                                                                                             NaN  
4498                                                                                             NaN  
1884                                                                                             NaN  
3323                                                                                             NaN  
4733                                                                                             NaN  
2401                                                                                             NaN  
5299                                                                                             NaN  
52                                                                                               NaN  
5557                                                                                             NaN  
5307                                                                                             NaN  
4424                                                                                             NaN  
3304                                                                                             NaN  
3319                                                                                             NaN  
4221                                                                                             NaN  
4422                                                                                             NaN  
1844                                                                                             NaN  
1730                                                                                             NaN  
2132                                                                                             NaN  
3841                                                                                             NaN  
914                                                                                              NaN  
3047                                                                                             NaN  
4410                                                                                             NaN  
3840                                                                                             NaN  
5554                                                                                             NaN  
1528                                                                                             NaN  
3023                                                                                             NaN  
1579                                                                                             NaN  
5549                                                                                             NaN  
2406                                                                                             NaN  
2573                                                                                             NaN  
3494                                                                                             NaN  
5300                                                                                             NaN  
3905                                                                                             NaN  
5302                                                                                             NaN  
667                                                                                              NaN  
6002                                                                                             NaN  
5295                                                                                             NaN  
6184        SUBTLE_PAYEE_MISMATCH: Payee changed from 'Buck-Kelly Solutions' to 'Buck-Kelly Systems'  
3486                                                                                             NaN  
5283                                                                                             NaN  
1591                                                                                             NaN  
5285                                                                                             NaN  
3554                                                                                             NaN  
4048                                                                                             NaN  
2166                                                                                             NaN  
6076                                                                                             NaN  
3314                                                                                             NaN  
5027                                                                                             NaN  
5553                                                                                             NaN  
413                                                                                              NaN  
3299                                                                                             NaN  
5706                                                                                             NaN  
4416                                                                                             NaN  
4734                                                                                             NaN  
2134                                                                                             NaN  
4947                                                                                             NaN  
5455                                                                                             NaN  
693                                                                                              NaN  
5556                                                                                             NaN  
4727                                                                                             NaN  
4743                                                                                             NaN  
5291                                                                                             NaN  
5775                                                                                             NaN  
4722                                                                                             NaN  
5305                                                                                             NaN  
5280                                                                                             NaN  
4413                                                                                             NaN  
5008                                                                                             NaN  
4737                                                                                             NaN  
2748                                                                                             NaN  
993                                                                                              NaN  
5217                                                                                             NaN  
972                                                                                              NaN  
1016                                                                                             NaN  
3847                                                                                             NaN  
5303                                                                                             NaN  
4420                                                                                             NaN  
3292                                                                                             NaN  
5561                                                                                             NaN  
994                                                                                              NaN  
3331                                                                                             NaN  
4717                                                                                             NaN  
5301                                                                                             NaN  
5345                                                                                             NaN  
5294                                                                                             NaN  
5548                                                                                             NaN  
3999                                                                                             NaN  
1597                                                                                             NaN  
4710                                                                                             NaN  
4902                                                                                             NaN  
2704                                                                                             NaN  
4728                                                                                             NaN  
1039                                                                                             NaN  
4730                                                                                             NaN  
3601                                                                                             NaN  
5855                                                                                             NaN  
4739                                                                                             NaN  
2534                                                                                             NaN  
2611                                                                                             NaN  
5558                                                                                             NaN  
5429                                                                                             NaN  
5174                                                                                             NaN  
3227                                                                                             NaN  
4783                                                                                             NaN  
6081                                                                                             NaN  
1011                                                                                             NaN  

✓ Results saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_scores.csv
✓ Summary saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_summary.json

================================================================================
BUSINESS ANOMALY DETECTION EXPERIMENT COMPLETED!
================================================================================
ROC-AUC: 0.8509
Best F1: 0.2222
Normal correctly classified: 6128/6178
Anomalies detected         : 13/54
== Job abgeschlossen ==

============================= JOB FEEDBACK =============================

NodeName=uc2n913
Job ID: 2277976
Cluster: uc3
User/Group: ma_pkonz/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 2
CPU Utilized: 04:06:25
CPU Efficiency: 94.44% of 04:20:56 core-walltime
Job Wall-clock time: 02:10:28
Memory Utilized: 19.42 GB
Memory Efficiency: 60.70% of 32.00 GB (32.00 GB/node)
