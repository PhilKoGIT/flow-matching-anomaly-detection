== Job start ==
================================================================================
LOADING & PREPARING BUSINESS TRANSACTION DATA
================================================================================
✓ Original data saved to data/original_data.csv
✓ Index mappings saved to data/train_mapping.csv and data/test_mapping.csv
✓ Feature columns saved to data/feature_columns.json
✓ preprocessed_full_dataset.csv saved to data/

Shapes nach Preprocessing:
  X_train: (24755, 9)
  X_test : (6189, 9)
  y_train: (24755,), Anomalien = 43 (0.17%)
  y_test : (6189,), Anomalien = 11 (0.18%)

Feature matrix shapes (nach Drop von bank_account_uuid):
  X_train: (24755, 8)
  X_test : (6189, 8)

Test-Label-Verteilung (0=normal, 1=anomaly):
  Normal : 6178 (99.82%)
  Anomaly: 11 (0.18%)

================================================================================
TRAIN of FORESTDIFFUSION MODEL ON FULL TRAINING DATA
================================================================================
✓ Model trained successfully on full training data!

================================================================================
COMPUTING ANOMALY SCORES AUF TESTSET
================================================================================
✓ Anomaly scores computed: 6189
  Score range: [1.7582, 32.9678]
  Score mean : 4.3590
  Score std  : 2.2192

================================================================================
EVALUATION METRICS
================================================================================

✓ ROC-AUC Score: 0.8840

Performance at different threshold percentiles:
--------------------------------------------------------------------------------

90th Percentile (threshold=5.5218):
  Precision: 0.0113 | Recall: 0.6364 | F1: 0.0222 | Acc: 0.9005
  Confusion Matrix: TP=7, FP=612, TN=5566, FN=4

95th Percentile (threshold=7.0024):
  Precision: 0.0226 | Recall: 0.6364 | F1: 0.0436 | Acc: 0.9504
  Confusion Matrix: TP=7, FP=303, TN=5875, FN=4

97.5th Percentile (threshold=10.0378):
  Precision: 0.0452 | Recall: 0.6364 | F1: 0.0843 | Acc: 0.9754
  Confusion Matrix: TP=7, FP=148, TN=6030, FN=4

99th Percentile (threshold=14.2619):
  Precision: 0.0806 | Recall: 0.4545 | F1: 0.1370 | Acc: 0.9898
  Confusion Matrix: TP=5, FP=57, TN=6121, FN=6

99.5th Percentile (threshold=18.3068):
  Precision: 0.0645 | Recall: 0.1818 | F1: 0.0952 | Acc: 0.9939
  Confusion Matrix: TP=2, FP=29, TN=6149, FN=9

99.9th Percentile (threshold=24.7164):
  Precision: 0.1429 | Recall: 0.0909 | F1: 0.1111 | Acc: 0.9974
  Confusion Matrix: TP=1, FP=6, TN=6172, FN=10

✓ Best F1-Score: 0.1370 at 99th percentile (threshold=14.2619)

Final confusion matrix at best F1 threshold:
[[6121   57]
 [   6    5]]
  Normal correctly classified: 6121/6178
  Anomalies detected          : 5/11

================================================================================
CREATING VISUALIZATIONS
================================================================================
✓ Saved plot to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_detection_results.png

================================================================================
SAVING RESULTS
================================================================================

Top highest anomaly scores:
      test_index  original_index  is_anomaly  anomaly_score  \
5776        5776           13313           0      32.967769   
4983        4983            5980           0      31.643662   
4021        4021           20696           0      29.394061   
4656        4656           12201           0      29.389406   
6043        6043           27566           0      26.535473   
5758        5758            5560           1      26.184447   
5919        5919           18091           0      24.759944   
3763        3763           22540           0      24.528572   
5206        5206           27802           0      23.644777   
5491        5491            4738           0      23.498566   
5241        5241            5831           0      23.310143   
2891        2891           30384           0      23.172088   
4955        4955           16817           0      22.745840   
4358        4358           19117           0      22.458079   
4641        4641           12789           0      22.005645   
1788        1788           12866           0      21.795299   
1648        1648           30554           0      21.679424   
4325        4325           12522           0      21.299550   
2885        2885            4818           0      20.807158   
1214        1214           20075           0      20.304031   
6091        6091            9303           0      20.058942   
5912        5912           24321           0      20.023201   
5757        5757           15284           1      19.996757   
1368        1368           10873           0      19.939164   
3886        3886           15001           0      19.924637   
4136        4136            1621           0      19.810049   
617          617             489           0      19.623365   
6037        6037           23139           0      19.590813   
2063        2063           30050           0      18.746121   
5832        5832           18283           0      18.495702   
5634        5634           29099           0      18.440878   
5306        5306           29038           0      18.298228   
1474        1474           20500           0      18.264381   
4495        4495           27757           0      18.132992   
1918        1918            9499           0      18.086770   
723          723           22463           0      18.045809   
2633        2633            7471           1      17.932918   
3237        3237           14636           0      17.914663   
3617        3617            2823           0      17.774342   
5508        5508           19398           0      17.743904   
1041        1041            6582           0      17.333744   
4657        4657             461           0      16.959759   
2069        2069            5424           0      16.855059   
2335        2335            3970           0      16.824530   
5764        5764           19109           0      16.741119   
2185        2185            4281           0      16.365687   
318          318           15485           0      16.219346   
206          206           19402           0      16.106037   
4195        4195            7215           0      15.988518   
583          583           11181           0      15.761063   
3222        3222           20121           0      15.567300   
2408        2408            8430           1      15.487398   
4760        4760           22420           0      15.471066   
4822        4822            3297           0      15.440227   
4802        4802           24981           0      15.176188   
5126        5126            4723           0      14.866424   
568          568           21630           1      14.823240   
911          911           22752           0      14.643370   
4181        4181           27164           0      14.612508   
5104        5104           11353           0      14.430562   
441          441            4725           0      14.328100   
5561        5561           18065           0      14.276164   
3486        3486           22102           0      14.259943   
4042        4042           23668           0      14.176218   
4457        4457           19745           0      14.060812   
5232        5232           10635           0      13.984662   
4000        4000           21742           1      13.929095   
2310        2310           10271           0      13.888647   
3485        3485            2052           0      13.877280   
4912        4912           11415           0      13.850471   
5340        5340            8372           0      13.656535   
3331        3331           21306           0      13.597858   
2458        2458           24937           0      13.521275   
5723        5723           21605           0      13.513080   
5058        5058            2886           0      13.505466   
2743        2743           16836           0      13.430927   
3761        3761           17585           0      13.424157   
2698        2698           24569           0      13.384207   
5472        5472           23223           0      13.303273   
4041        4041             414           0      13.225815   
3762        3762           25477           0      13.197865   
5869        5869            5388           0      13.190978   
3719        3719           26680           0      13.020936   
3924        3924           25201           0      12.837951   
5722        5722            2389           0      12.802384   
5469        5469           19142           0      12.781580   
4344        4344           16590           0      12.702030   
4318        4318           18846           0      12.659357   
3480        3480           22872           0      12.638037   
2603        2603           21767           0      12.557456   
4605        4605           11057           0      12.542944   
5238        5238           28386           0      12.510564   
3173        3173           13150           0      12.502895   
2598        2598           26685           0      12.501294   
4157        4157             561           0      12.497155   
2474        2474           24820           0      12.376422   
5993        5993           30196           0      12.212429   
3968        3968             733           1      12.169083   
4968        4968           29809           0      12.130174   
3034        3034            7396           0      12.024376   
1370        1370            2646           0      11.930546   
4424        4424           12444           0      11.843002   
5488        5488           26818           0      11.838174   
1884        1884            2343           0      11.832180   
5443        5443            1933           0      11.782471   
4285        4285            3775           0      11.702642   
3057        3057            7048           0      11.681791   
4443        4443            4220           0      11.617641   
5913        5913            1162           0      11.614778   
3313        3313            4771           0      11.546849   
906          906           30176           0      11.534862   
6090        6090           10569           0      11.530873   
5621        5621           15119           0      11.524133   
3358        3358           20099           0      11.493347   
3584        3584           18151           0      11.485458   
2855        2855           24309           0      11.453342   
3228        3228           26392           0      11.439942   
5511        5511           19208           0      11.439826   
3171        3171            3879           0      11.302084   
1769        1769           15817           0      11.191141   
2769        2769           12008           0      11.175768   
5182        5182           10678           0      11.086743   
5355        5355           28960           0      11.083393   
1675        1675            7920           0      11.082401   
2934        2934            2180           0      11.073934   
4927        4927           29100           0      11.027768   
5100        5100             355           0      10.982890   
5307        5307           22858           0      10.951458   
3042        3042            6448           0      10.946836   
6101        6101           23400           0      10.911205   
1489        1489           16304           0      10.890616   
2614        2614            7778           0      10.887409   
2568        2568           25972           0      10.884443   
3868        3868           29840           0      10.862090   
734          734           25942           0      10.755524   
4454        4454            2991           0      10.748201   
2280        2280            3876           0      10.694911   
1179        1179           13130           0      10.670640   
2875        2875            6158           0      10.659200   
5724        5724           19905           0      10.657131   
5804        5804           10680           0      10.649448   
3438        3438           20424           0      10.588753   
5188        5188            7880           0      10.489269   
5221        5221           12155           0      10.385843   
2887        2887           21146           0      10.362722   
2275        2275           21732           0      10.310668   
4516        4516           24627           0      10.296179   
52            52            7694           0      10.269475   
3787        3787           27746           0      10.210224   
4791        4791           14309           0      10.126287   
3738        3738           18285           0      10.115745   
1935        1935           18649           0      10.109682   
5598        5598           13912           0      10.071726   
1733        1733           18221           0      10.056433   
2009        2009            8040           0      10.053349   
4727        4727           19440           0      10.031119   
1850        1850           20991           0      10.026027   
2578        2578            2790           0      10.002485   
4603        4603           29085           0       9.995474   
1776        1776            7217           0       9.959030   
2311        2311           29748           0       9.942970   
3999        3999            3473           0       9.939617   
5735        5735           18408           0       9.925451   
4133        4133           12498           0       9.919530   
4007        4007            6551           0       9.919178   
683          683           28078           0       9.915710   
5156        5156            9980           0       9.892457   
4777        4777            6778           0       9.879361   
6102        6102           11789           0       9.827521   
4507        4507           18070           0       9.752048   
4117        4117           26217           0       9.722541   
3857        3857           21138           0       9.682910   
2284        2284            1649           0       9.681180   
5585        5585            8119           0       9.665784   
5873        5873           23261           0       9.662888   
3233        3233            1181           0       9.649767   
2271        2271             364           0       9.648699   
5715        5715           24273           0       9.644042   
4762        4762           13771           0       9.639209   
3925        3925           25293           0       9.624469   
5969        5969             311           0       9.621151   
5384        5384            7320           0       9.601100   
5021        5021            7553           0       9.580879   
3500        3500           24307           0       9.548614   
3859        3859             272           0       9.529383   
2014        2014           21896           0       9.454428   
2151        2151           16990           0       9.438774   
4580        4580           18294           0       9.430947   
4322        4322            9477           0       9.412089   
1761        1761           11933           0       9.409421   
3911        3911            6995           0       9.382485   
3143        3143           22897           0       9.375541   
2616        2616           18867           0       9.355610   
5064        5064            1912           0       9.351388   
4911        4911            5287           0       9.305327   
1317        1317           29024           0       9.269692   
1618        1618            5169           0       9.258446   
5655        5655           18648           0       9.242698   
5902        5902           16305           0       9.218680   
4056        4056           30122           0       9.160746   
5438        5438           26178           0       9.116796   
3585        3585           24237           0       9.111939   
4792        4792           24417           0       9.054272   
5464        5464           27532           0       9.047651   
2579        2579           10769           0       9.045608   
5060        5060            1370           0       9.043647   
2436        2436           30637           0       9.017263   
5317        5317            6869           0       8.994138   
3492        3492            4772           0       8.991603   
2010        2010            7997           0       8.987181   
1531        1531            8540           0       8.981289   
4448        4448           13859           0       8.977095   
2170        2170           19503           0       8.948094   
2042        2042             497           0       8.909077   
4725        4725           24731           0       8.903376   
1492        1492           14353           0       8.866645   
5226        5226           19017           0       8.862421   
856          856           18297           0       8.855840   
2721        2721           12443           0       8.815624   
4230        4230            3351           0       8.758851   
3029        3029            3883           0       8.747500   
2148        2148            3837           0       8.708796   
1731        1731            5998           0       8.694518   
3053        3053           25143           0       8.664076   
5487        5487           26291           0       8.642855   
5868        5868            6447           0       8.627927   
4121        4121           23059           0       8.574607   
4210        4210            9505           0       8.550692   
721          721           12812           0       8.549690   
5183        5183           24797           0       8.547454   
2539        2539           13924           0       8.541657   
5460        5460            2428           0       8.525440   
3354        3354            2169           0       8.480270   
1164        1164           14429           0       8.422807   
5318        5318           26756           0       8.397699   
6095        6095           10266           0       8.377018   
4956        4956            9443           0       8.341352   
426          426           11693           0       8.267285   
1042        1042           22118           0       8.263605   
2405        2405           10881           0       8.254436   
2299        2299           25312           0       8.248055   
2589        2589           26117           0       8.224989   
3402        3402           20196           0       8.219747   
4671        4671            4265           0       8.191549   
2754        2754           23370           0       8.097108   
6100        6100           26450           0       8.094044   
5037        5037           16446           0       8.086529   
2870        2870           21650           0       8.083862   
4496        4496            8168           0       8.058266   
5768        5768            4155           0       8.036216   
6013        6013            3555           0       8.005120   
1009        1009            5143           0       7.988424   
4447        4447           15379           0       7.986192   
5492        5492           21034           0       7.951790   
3560        3560           10620           0       7.947542   
4630        4630           22381           0       7.932040   
3435        3435           29551           0       7.931684   
3778        3778           17455           0       7.912402   
3632        3632           17369           0       7.908163   
916          916           21609           0       7.895702   
5786        5786           14985           0       7.868702   
3145        3145           11498           0       7.857803   
5354        5354           10233           0       7.845564   
2877        2877           19428           0       7.838692   
5865        5865            8088           0       7.816108   
1019        1019           11332           0       7.810718   
1180        1180           28838           0       7.780073   
4109        4109            9567           0       7.759512   
5043        5043           14686           0       7.725292   
326          326            8004           0       7.644502   
3321        3321           30136           0       7.619845   
1594        1594            4992           0       7.598897   
4897        4897           27285           0       7.552902   
4003        4003            8046           0       7.535642   
3915        3915           11592           0       7.523640   
4967        4967           17255           0       7.512177   
3044        3044           18937           0       7.467926   
4331        4331           17593           0       7.440107   
2004        2004           30889           0       7.436786   
2712        2712           19218           0       7.428913   
3329        3329           25101           0       7.428491   
6117        6117             110           0       7.423929   
4907        4907           23061           0       7.407757   
3571        3571            8368           0       7.384869   
5036        5036           13474           0       7.383810   
2930        2930            4499           0       7.377862   
5315        5315           11909           0       7.362102   
5643        5643            3833           0       7.348863   
5746        5746           12609           0       7.333119   
1000        1000           25261           0       7.288843   
5482        5482            5027           0       7.281651   
3183        3183            3013           0       7.278124   
5323        5323           17464           0       7.272567   
5888        5888            4125           0       7.240275   
1004        1004           24258           0       7.237742   
3607        3607           16635           0       7.194654   
5559        5559           14784           0       7.183844   
1079        1079            8796           0       7.181912   
4750        4750            1132           0       7.144973   
3443        3443            6034           0       7.132392   
5728        5728           27302           0       7.104344   
4014        4014           21853           0       7.089615   
3615        3615            8482           0       7.087297   
5714        5714            4401           0       7.085096   
1292        1292           12974           0       7.075700   
3208        3208           16209           0       7.051711   
2178        2178           11999           0       7.040297   
5999        5999           10501           0       7.028530   
3724        3724            3524           0       7.026657   
5478        5478            9591           0       7.007323   
1496        1496            4222           0       6.995129   
4923        4923             239           0       6.994659   
5196        5196           27345           0       6.978379   
5099        5099           30188           0       6.975574   
4667        4667            3605           0       6.958420   
6033        6033           30609           0       6.955287   
5914        5914           13165           0       6.931743   
4780        4780           23446           0       6.916050   
5338        5338           17892           0       6.905803   
2922        2922           27256           0       6.897143   
2126        2126           24739           0       6.886015   
5572        5572            8007           0       6.868884   
4058        4058           21425           0       6.841225   
1234        1234           17241           0       6.837978   
5617        5617           26123           0       6.792972   
5463        5463           26939           0       6.739497   
218          218           29428           0       6.718817   
4009        4009            2223           0       6.716523   
2456        2456           27180           0       6.670246   
6099        6099           14186           0       6.669726   
3151        3151           24454           0       6.648199   
1157        1157            3915           0       6.632263   
3723        3723             400           0       6.629086   
1291        1291           22819           0       6.628230   
164          164           29005           0       6.621154   
4960        4960           29563           0       6.610355   
697          697           28356           0       6.551789   
5595        5595            4386           0       6.539292   
6              6           11861           0       6.531193   
4919        4919           10874           0       6.504871   
1464        1464           11115           0       6.502168   
5599        5599           25305           0       6.467418   
759          759            5826           0       6.464918   
6085        6085             227           0       6.448642   
3225        3225           22280           0       6.444567   
3059        3059           15243           0       6.434581   
5201        5201           29768           0       6.429410   
3759        3759            2892           0       6.427440   
4019        4019            7059           0       6.408988   
4262        4262           17004           0       6.390442   
1754        1754           11494           0       6.385851   
142          142           25740           0       6.379944   
3434        3434           10433           0       6.379883   
1297        1297           19576           0       6.376086   
4783        4783           28709           0       6.372513   
3772        3772           27847           0       6.364733   
4651        4651           21576           0       6.361541   
4303        4303           28639           0       6.358148   
4324        4324           23507           0       6.356075   
6086        6086           12535           0       6.328831   
4609        4609            7958           0       6.316146   
64            64           11033           0       6.295681   
4439        4439           11842           0       6.293172   
302          302           25012           0       6.284796   
3654        3654           18609           0       6.270654   
1597        1597           12400           0       6.269449   
6039        6039            8553           0       6.268823   
184          184           10750           0       6.260280   
4353        4353           20914           0       6.258821   
5192        5192            8969           0       6.258197   
1075        1075           26688           0       6.252076   
4643        4643           23851           0       6.251492   
4194        4194           18556           0       6.233090   
5846        5846           14048           0       6.219623   
6166        6166           21981           0       6.210644   
3863        3863           25567           0       6.206868   
5867        5867           21699           0       6.188980   
3362        3362           12064           0       6.169031   
5863        5863           19125           0       6.165466   
6165        6165           17925           0       6.159684   
1941        1941           29647           0       6.158092   
4010        4010           10641           0       6.154548   
6178        6178           24143           0       6.140060   
5321        5321           25334           0       6.139820   
5216        5216           26285           0       6.107774   
5564        5564            5869           0       6.106322   
2174        2174           23501           0       6.104197   
6129        6129           23910           0       6.104001   
5586        5586           10945           0       6.102096   
4471        4471           13222           0       6.099788   
5594        5594           23643           0       6.093561   
5382        5382           18268           0       6.084176   
5891        5891            2523           0       6.069869   
4751        4751           22641           0       6.063434   
5571        5571             271           0       6.062976   
608          608           28172           0       6.061959   
3927        3927            6926           0       6.048753   
6012        6012           23581           0       6.038874   
1219        1219           17860           0       6.037308   
2072        2072           25205           0       6.022675   

      predicted_anomaly  \
5776                  1   
4983                  1   
4021                  1   
4656                  1   
6043                  1   
5758                  1   
5919                  1   
3763                  1   
5206                  1   
5491                  1   
5241                  1   
2891                  1   
4955                  1   
4358                  1   
4641                  1   
1788                  1   
1648                  1   
4325                  1   
2885                  1   
1214                  1   
6091                  1   
5912                  1   
5757                  1   
1368                  1   
3886                  1   
4136                  1   
617                   1   
6037                  1   
2063                  1   
5832                  1   
5634                  1   
5306                  1   
1474                  1   
4495                  1   
1918                  1   
723                   1   
2633                  1   
3237                  1   
3617                  1   
5508                  1   
1041                  1   
4657                  1   
2069                  1   
2335                  1   
5764                  1   
2185                  1   
318                   1   
206                   1   
4195                  1   
583                   1   
3222                  1   
2408                  1   
4760                  1   
4822                  1   
4802                  1   
5126                  1   
568                   1   
911                   1   
4181                  1   
5104                  1   
441                   1   
5561                  1   
3486                  0   
4042                  0   
4457                  0   
5232                  0   
4000                  0   
2310                  0   
3485                  0   
4912                  0   
5340                  0   
3331                  0   
2458                  0   
5723                  0   
5058                  0   
2743                  0   
3761                  0   
2698                  0   
5472                  0   
4041                  0   
3762                  0   
5869                  0   
3719                  0   
3924                  0   
5722                  0   
5469                  0   
4344                  0   
4318                  0   
3480                  0   
2603                  0   
4605                  0   
5238                  0   
3173                  0   
2598                  0   
4157                  0   
2474                  0   
5993                  0   
3968                  0   
4968                  0   
3034                  0   
1370                  0   
4424                  0   
5488                  0   
1884                  0   
5443                  0   
4285                  0   
3057                  0   
4443                  0   
5913                  0   
3313                  0   
906                   0   
6090                  0   
5621                  0   
3358                  0   
3584                  0   
2855                  0   
3228                  0   
5511                  0   
3171                  0   
1769                  0   
2769                  0   
5182                  0   
5355                  0   
1675                  0   
2934                  0   
4927                  0   
5100                  0   
5307                  0   
3042                  0   
6101                  0   
1489                  0   
2614                  0   
2568                  0   
3868                  0   
734                   0   
4454                  0   
2280                  0   
1179                  0   
2875                  0   
5724                  0   
5804                  0   
3438                  0   
5188                  0   
5221                  0   
2887                  0   
2275                  0   
4516                  0   
52                    0   
3787                  0   
4791                  0   
3738                  0   
1935                  0   
5598                  0   
1733                  0   
2009                  0   
4727                  0   
1850                  0   
2578                  0   
4603                  0   
1776                  0   
2311                  0   
3999                  0   
5735                  0   
4133                  0   
4007                  0   
683                   0   
5156                  0   
4777                  0   
6102                  0   
4507                  0   
4117                  0   
3857                  0   
2284                  0   
5585                  0   
5873                  0   
3233                  0   
2271                  0   
5715                  0   
4762                  0   
3925                  0   
5969                  0   
5384                  0   
5021                  0   
3500                  0   
3859                  0   
2014                  0   
2151                  0   
4580                  0   
4322                  0   
1761                  0   
3911                  0   
3143                  0   
2616                  0   
5064                  0   
4911                  0   
1317                  0   
1618                  0   
5655                  0   
5902                  0   
4056                  0   
5438                  0   
3585                  0   
4792                  0   
5464                  0   
2579                  0   
5060                  0   
2436                  0   
5317                  0   
3492                  0   
2010                  0   
1531                  0   
4448                  0   
2170                  0   
2042                  0   
4725                  0   
1492                  0   
5226                  0   
856                   0   
2721                  0   
4230                  0   
3029                  0   
2148                  0   
1731                  0   
3053                  0   
5487                  0   
5868                  0   
4121                  0   
4210                  0   
721                   0   
5183                  0   
2539                  0   
5460                  0   
3354                  0   
1164                  0   
5318                  0   
6095                  0   
4956                  0   
426                   0   
1042                  0   
2405                  0   
2299                  0   
2589                  0   
3402                  0   
4671                  0   
2754                  0   
6100                  0   
5037                  0   
2870                  0   
4496                  0   
5768                  0   
6013                  0   
1009                  0   
4447                  0   
5492                  0   
3560                  0   
4630                  0   
3435                  0   
3778                  0   
3632                  0   
916                   0   
5786                  0   
3145                  0   
5354                  0   
2877                  0   
5865                  0   
1019                  0   
1180                  0   
4109                  0   
5043                  0   
326                   0   
3321                  0   
1594                  0   
4897                  0   
4003                  0   
3915                  0   
4967                  0   
3044                  0   
4331                  0   
2004                  0   
2712                  0   
3329                  0   
6117                  0   
4907                  0   
3571                  0   
5036                  0   
2930                  0   
5315                  0   
5643                  0   
5746                  0   
1000                  0   
5482                  0   
3183                  0   
5323                  0   
5888                  0   
1004                  0   
3607                  0   
5559                  0   
1079                  0   
4750                  0   
3443                  0   
5728                  0   
4014                  0   
3615                  0   
5714                  0   
1292                  0   
3208                  0   
2178                  0   
5999                  0   
3724                  0   
5478                  0   
1496                  0   
4923                  0   
5196                  0   
5099                  0   
4667                  0   
6033                  0   
5914                  0   
4780                  0   
5338                  0   
2922                  0   
2126                  0   
5572                  0   
4058                  0   
1234                  0   
5617                  0   
5463                  0   
218                   0   
4009                  0   
2456                  0   
6099                  0   
3151                  0   
1157                  0   
3723                  0   
1291                  0   
164                   0   
4960                  0   
697                   0   
5595                  0   
6                     0   
4919                  0   
1464                  0   
5599                  0   
759                   0   
6085                  0   
3225                  0   
3059                  0   
5201                  0   
3759                  0   
4019                  0   
4262                  0   
1754                  0   
142                   0   
3434                  0   
1297                  0   
4783                  0   
3772                  0   
4651                  0   
4303                  0   
4324                  0   
6086                  0   
4609                  0   
64                    0   
4439                  0   
302                   0   
3654                  0   
1597                  0   
6039                  0   
184                   0   
4353                  0   
5192                  0   
1075                  0   
4643                  0   
4194                  0   
5846                  0   
6166                  0   
3863                  0   
5867                  0   
3362                  0   
5863                  0   
6165                  0   
1941                  0   
4010                  0   
6178                  0   
5321                  0   
5216                  0   
5564                  0   
2174                  0   
6129                  0   
5586                  0   
4471                  0   
5594                  0   
5382                  0   
5891                  0   
4751                  0   
5571                  0   
608                   0   
3927                  0   
6012                  0   
1219                  0   
2072                  0   

                                                          anomaly_description  
5776                                                                      NaN  
4983                                                                      NaN  
4021                                                                      NaN  
4656                                                                      NaN  
6043                                                                      NaN  
5758                              AMOUNT_ANOMALY: Amount changed from ~708309  
5919                                                                      NaN  
3763                                                                      NaN  
5206                                                                      NaN  
5491                                                                      NaN  
5241                                                                      NaN  
2891                                                                      NaN  
4955                                                                      NaN  
4358                                                                      NaN  
4641                                                                      NaN  
1788                                                                      NaN  
1648                                                                      NaN  
4325                                                                      NaN  
2885                                                                      NaN  
1214                                                                      NaN  
6091                                                                      NaN  
5912                                                                      NaN  
5757  IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB35VJGS13...  
1368                                                                      NaN  
3886                                                                      NaN  
4136                                                                      NaN  
617                                                                       NaN  
6037                                                                      NaN  
2063                                                                      NaN  
5832                                                                      NaN  
5634                                                                      NaN  
5306                                                                      NaN  
1474                                                                      NaN  
4495                                                                      NaN  
1918                                                                      NaN  
723                                                                       NaN  
2633  IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB80JWGI98...  
3237                                                                      NaN  
3617                                                                      NaN  
5508                                                                      NaN  
1041                                                                      NaN  
4657                                                                      NaN  
2069                                                                      NaN  
2335                                                                      NaN  
5764                                                                      NaN  
2185                                                                      NaN  
318                                                                       NaN  
206                                                                       NaN  
4195                                                                      NaN  
583                                                                       NaN  
3222                                                                      NaN  
2408              PAYEE_ANOMALY: Payee changed from Barton-Anderson Solutions  
4760                                                                      NaN  
4822                                                                      NaN  
4802                                                                      NaN  
5126                                                                      NaN  
568      CHANNEL_ANOMALY: Payment made via CARD/MOBILE_APP instead of ACH/API  
911                                                                       NaN  
4181                                                                      NaN  
5104                                                                      NaN  
441                                                                       NaN  
5561                                                                      NaN  
3486                                                                      NaN  
4042                                                                      NaN  
4457                                                                      NaN  
5232                                                                      NaN  
4000                             FREQUENCY_ANOMALY: Duplicate monthly payment  
2310                                                                      NaN  
3485                                                                      NaN  
4912                                                                      NaN  
5340                                                                      NaN  
3331                                                                      NaN  
2458                                                                      NaN  
5723                                                                      NaN  
5058                                                                      NaN  
2743                                                                      NaN  
3761                                                                      NaN  
2698                                                                      NaN  
5472                                                                      NaN  
4041                                                                      NaN  
3762                                                                      NaN  
5869                                                                      NaN  
3719                                                                      NaN  
3924                                                                      NaN  
5722                                                                      NaN  
5469                                                                      NaN  
4344                                                                      NaN  
4318                                                                      NaN  
3480                                                                      NaN  
2603                                                                      NaN  
4605                                                                      NaN  
5238                                                                      NaN  
3173                                                                      NaN  
2598                                                                      NaN  
4157                                                                      NaN  
2474                                                                      NaN  
5993                                                                      NaN  
3968                             FREQUENCY_ANOMALY: Duplicate monthly payment  
4968                                                                      NaN  
3034                                                                      NaN  
1370                                                                      NaN  
4424                                                                      NaN  
5488                                                                      NaN  
1884                                                                      NaN  
5443                                                                      NaN  
4285                                                                      NaN  
3057                                                                      NaN  
4443                                                                      NaN  
5913                                                                      NaN  
3313                                                                      NaN  
906                                                                       NaN  
6090                                                                      NaN  
5621                                                                      NaN  
3358                                                                      NaN  
3584                                                                      NaN  
2855                                                                      NaN  
3228                                                                      NaN  
5511                                                                      NaN  
3171                                                                      NaN  
1769                                                                      NaN  
2769                                                                      NaN  
5182                                                                      NaN  
5355                                                                      NaN  
1675                                                                      NaN  
2934                                                                      NaN  
4927                                                                      NaN  
5100                                                                      NaN  
5307                                                                      NaN  
3042                                                                      NaN  
6101                                                                      NaN  
1489                                                                      NaN  
2614                                                                      NaN  
2568                                                                      NaN  
3868                                                                      NaN  
734                                                                       NaN  
4454                                                                      NaN  
2280                                                                      NaN  
1179                                                                      NaN  
2875                                                                      NaN  
5724                                                                      NaN  
5804                                                                      NaN  
3438                                                                      NaN  
5188                                                                      NaN  
5221                                                                      NaN  
2887                                                                      NaN  
2275                                                                      NaN  
4516                                                                      NaN  
52                                                                        NaN  
3787                                                                      NaN  
4791                                                                      NaN  
3738                                                                      NaN  
1935                                                                      NaN  
5598                                                                      NaN  
1733                                                                      NaN  
2009                                                                      NaN  
4727                                                                      NaN  
1850                                                                      NaN  
2578                                                                      NaN  
4603                                                                      NaN  
1776                                                                      NaN  
2311                                                                      NaN  
3999                                                                      NaN  
5735                                                                      NaN  
4133                                                                      NaN  
4007                                                                      NaN  
683                                                                       NaN  
5156                                                                      NaN  
4777                                                                      NaN  
6102                                                                      NaN  
4507                                                                      NaN  
4117                                                                      NaN  
3857                                                                      NaN  
2284                                                                      NaN  
5585                                                                      NaN  
5873                                                                      NaN  
3233                                                                      NaN  
2271                                                                      NaN  
5715                                                                      NaN  
4762                                                                      NaN  
3925                                                                      NaN  
5969                                                                      NaN  
5384                                                                      NaN  
5021                                                                      NaN  
3500                                                                      NaN  
3859                                                                      NaN  
2014                                                                      NaN  
2151                                                                      NaN  
4580                                                                      NaN  
4322                                                                      NaN  
1761                                                                      NaN  
3911                                                                      NaN  
3143                                                                      NaN  
2616                                                                      NaN  
5064                                                                      NaN  
4911                                                                      NaN  
1317                                                                      NaN  
1618                                                                      NaN  
5655                                                                      NaN  
5902                                                                      NaN  
4056                                                                      NaN  
5438                                                                      NaN  
3585                                                                      NaN  
4792                                                                      NaN  
5464                                                                      NaN  
2579                                                                      NaN  
5060                                                                      NaN  
2436                                                                      NaN  
5317                                                                      NaN  
3492                                                                      NaN  
2010                                                                      NaN  
1531                                                                      NaN  
4448                                                                      NaN  
2170                                                                      NaN  
2042                                                                      NaN  
4725                                                                      NaN  
1492                                                                      NaN  
5226                                                                      NaN  
856                                                                       NaN  
2721                                                                      NaN  
4230                                                                      NaN  
3029                                                                      NaN  
2148                                                                      NaN  
1731                                                                      NaN  
3053                                                                      NaN  
5487                                                                      NaN  
5868                                                                      NaN  
4121                                                                      NaN  
4210                                                                      NaN  
721                                                                       NaN  
5183                                                                      NaN  
2539                                                                      NaN  
5460                                                                      NaN  
3354                                                                      NaN  
1164                                                                      NaN  
5318                                                                      NaN  
6095                                                                      NaN  
4956                                                                      NaN  
426                                                                       NaN  
1042                                                                      NaN  
2405                                                                      NaN  
2299                                                                      NaN  
2589                                                                      NaN  
3402                                                                      NaN  
4671                                                                      NaN  
2754                                                                      NaN  
6100                                                                      NaN  
5037                                                                      NaN  
2870                                                                      NaN  
4496                                                                      NaN  
5768                                                                      NaN  
6013                                                                      NaN  
1009                                                                      NaN  
4447                                                                      NaN  
5492                                                                      NaN  
3560                                                                      NaN  
4630                                                                      NaN  
3435                                                                      NaN  
3778                                                                      NaN  
3632                                                                      NaN  
916                                                                       NaN  
5786                                                                      NaN  
3145                                                                      NaN  
5354                                                                      NaN  
2877                                                                      NaN  
5865                                                                      NaN  
1019                                                                      NaN  
1180                                                                      NaN  
4109                                                                      NaN  
5043                                                                      NaN  
326                                                                       NaN  
3321                                                                      NaN  
1594                                                                      NaN  
4897                                                                      NaN  
4003                                                                      NaN  
3915                                                                      NaN  
4967                                                                      NaN  
3044                                                                      NaN  
4331                                                                      NaN  
2004                                                                      NaN  
2712                                                                      NaN  
3329                                                                      NaN  
6117                                                                      NaN  
4907                                                                      NaN  
3571                                                                      NaN  
5036                                                                      NaN  
2930                                                                      NaN  
5315                                                                      NaN  
5643                                                                      NaN  
5746                                                                      NaN  
1000                                                                      NaN  
5482                                                                      NaN  
3183                                                                      NaN  
5323                                                                      NaN  
5888                                                                      NaN  
1004                                                                      NaN  
3607                                                                      NaN  
5559                                                                      NaN  
1079                                                                      NaN  
4750                                                                      NaN  
3443                                                                      NaN  
5728                                                                      NaN  
4014                                                                      NaN  
3615                                                                      NaN  
5714                                                                      NaN  
1292                                                                      NaN  
3208                                                                      NaN  
2178                                                                      NaN  
5999                                                                      NaN  
3724                                                                      NaN  
5478                                                                      NaN  
1496                                                                      NaN  
4923                                                                      NaN  
5196                                                                      NaN  
5099                                                                      NaN  
4667                                                                      NaN  
6033                                                                      NaN  
5914                                                                      NaN  
4780                                                                      NaN  
5338                                                                      NaN  
2922                                                                      NaN  
2126                                                                      NaN  
5572                                                                      NaN  
4058                                                                      NaN  
1234                                                                      NaN  
5617                                                                      NaN  
5463                                                                      NaN  
218                                                                       NaN  
4009                                                                      NaN  
2456                                                                      NaN  
6099                                                                      NaN  
3151                                                                      NaN  
1157                                                                      NaN  
3723                                                                      NaN  
1291                                                                      NaN  
164                                                                       NaN  
4960                                                                      NaN  
697                                                                       NaN  
5595                                                                      NaN  
6                                                                         NaN  
4919                                                                      NaN  
1464                                                                      NaN  
5599                                                                      NaN  
759                                                                       NaN  
6085                                                                      NaN  
3225                                                                      NaN  
3059                                                                      NaN  
5201                                                                      NaN  
3759                                                                      NaN  
4019                                                                      NaN  
4262                                                                      NaN  
1754                                                                      NaN  
142                                                                       NaN  
3434                                                                      NaN  
1297                                                                      NaN  
4783                                                                      NaN  
3772                                                                      NaN  
4651                                                                      NaN  
4303                                                                      NaN  
4324                                                                      NaN  
6086                                                                      NaN  
4609                                                                      NaN  
64                                                                        NaN  
4439                                                                      NaN  
302                                                                       NaN  
3654                                                                      NaN  
1597                                                                      NaN  
6039                                                                      NaN  
184                                                                       NaN  
4353                                                                      NaN  
5192                                                                      NaN  
1075                                                                      NaN  
4643                                                                      NaN  
4194                                                                      NaN  
5846                                                                      NaN  
6166                                                                      NaN  
3863                                                                      NaN  
5867                                                                      NaN  
3362                                                                      NaN  
5863                                                                      NaN  
6165                                                                      NaN  
1941                                                                      NaN  
4010                                                                      NaN  
6178                                                                      NaN  
5321                                                                      NaN  
5216                                                                      NaN  
5564                                                                      NaN  
2174                                                                      NaN  
6129                                                                      NaN  
5586                                                                      NaN  
4471                                                                      NaN  
5594                                                                      NaN  
5382                                                                      NaN  
5891                                                                      NaN  
4751                                                                      NaN  
5571                                                                      NaN  
608                                                                       NaN  
3927                                                                      NaN  
6012                                                                      NaN  
1219                                                                      NaN  
2072                                                                      NaN  

✓ Results saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_scores.csv
✓ Summary saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_summary.json

================================================================================
BUSINESS ANOMALY DETECTION EXPERIMENT COMPLETED!
================================================================================
ROC-AUC: 0.8840
Best F1: 0.1370
Normal correctly classified: 6121/6178
Anomalies detected         : 5/11

Used Hyperparameters:
n_t: 100
duplicate_K: 20
diffusion_type: 'flow'
max_depth: 8
n_estimators: 150
eta: 0.3
dataset: Business Transaction Data
datset size (train/test): 24755/6189
== Job abgeschlossen ==

============================= JOB FEEDBACK =============================

NodeName=uc2n904
Job ID: 2235793
Cluster: uc3
User/Group: ma_pkonz/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 2
CPU Utilized: 02:10:07
CPU Efficiency: 89.04% of 02:26:08 core-walltime
Job Wall-clock time: 01:13:04
Memory Utilized: 5.55 GB
Memory Efficiency: 17.34% of 32.00 GB (32.00 GB/node)
