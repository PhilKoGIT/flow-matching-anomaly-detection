== Job start ==
================================================================================
LOADING & PREPARING BUSINESS TRANSACTION DATA
================================================================================
✓ Original data saved to data/original_data.csv
✓ Index mappings saved to data/train_mapping.csv and data/test_mapping.csv
✓ Feature columns saved to data/feature_columns.json
✓ preprocessed_full_dataset.csv saved to data/

Shapes nach Preprocessing:
  X_train: (24755, 12)
  X_test : (6189, 12)
  y_train: (24755,), Anomalien = 43 (0.17%)
  y_test : (6189,), Anomalien = 11 (0.18%)

Feature matrix shapes (nach Drop von bank_account_uuid):
  X_train: (24755, 11)
  X_test : (6189, 11)

Test-Label-Verteilung (0=normal, 1=anomaly):
  Normal : 6178 (99.82%)
  Anomaly: 11 (0.18%)

================================================================================
TRAIN of FORESTDIFFUSION MODEL ON FULL TRAINING DATA
================================================================================
✓ Model trained successfully on full training data!

================================================================================
COMPUTING ANOMALY SCORES AUF TESTSET
================================================================================
✓ Anomaly scores computed: 6189
  Score range: [2.5594, 34.9551]
  Score mean : 5.8496
  Score std  : 2.3761

================================================================================
EVALUATION METRICS
================================================================================

✓ ROC-AUC Score: 0.9415

Performance at different threshold percentiles:
--------------------------------------------------------------------------------

90th Percentile (threshold=7.8870):
  Precision: 0.0145 | Recall: 0.8182 | F1: 0.0286 | Acc: 0.9011
  Confusion Matrix: TP=9, FP=610, TN=5568, FN=2

95th Percentile (threshold=9.5286):
  Precision: 0.0290 | Recall: 0.8182 | F1: 0.0561 | Acc: 0.9510
  Confusion Matrix: TP=9, FP=301, TN=5877, FN=2

97.5th Percentile (threshold=11.5682):
  Precision: 0.0516 | Recall: 0.7273 | F1: 0.0964 | Acc: 0.9758
  Confusion Matrix: TP=8, FP=147, TN=6031, FN=3

99th Percentile (threshold=15.6819):
  Precision: 0.1129 | Recall: 0.6364 | F1: 0.1918 | Acc: 0.9905
  Confusion Matrix: TP=7, FP=55, TN=6123, FN=4

99.5th Percentile (threshold=19.6793):
  Precision: 0.1613 | Recall: 0.4545 | F1: 0.2381 | Acc: 0.9948
  Confusion Matrix: TP=5, FP=26, TN=6152, FN=6

99.9th Percentile (threshold=26.5866):
  Precision: 0.2857 | Recall: 0.1818 | F1: 0.2222 | Acc: 0.9977
  Confusion Matrix: TP=2, FP=5, TN=6173, FN=9

✓ Best F1-Score: 0.2381 at 99.5th percentile (threshold=19.6793)

Final confusion matrix at best F1 threshold:
[[6152   26]
 [   6    5]]
  Normal correctly classified: 6152/6178
  Anomalies detected          : 5/11

================================================================================
CREATING VISUALIZATIONS
================================================================================
✓ Saved plot to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_detection_results.png

================================================================================
SAVING RESULTS
================================================================================

Top highest anomaly scores:
      test_index  original_index  is_anomaly  anomaly_score  \
4983        4983            5980           0      34.955084   
930          930           14762           1      34.066970   
5776        5776           13313           0      32.107533   
4143        4143           29504           1      31.095299   
4021        4021           20696           0      29.564227   
4656        4656           12201           0      28.140784   
6043        6043           27566           0      26.794576   
5758        5758            5560           1      25.688325   
6091        6091            9303           0      25.261429   
5919        5919           18091           0      25.158838   
3763        3763           22540           0      24.066015   
5306        5306           29038           0      23.889681   
5206        5206           27802           0      23.839286   
5491        5491            4738           0      23.170162   
1788        1788           12866           0      23.073711   
2891        2891           30384           0      22.929233   
4358        4358           19117           0      22.801428   
5241        5241            5831           0      22.407180   
4955        4955           16817           0      22.392802   
1214        1214           20075           0      21.709073   
3886        3886           15001           0      21.457437   
4325        4325           12522           0      21.352759   
2885        2885            4818           0      21.307886   
4641        4641           12789           0      21.094157   
5757        5757           15284           1      20.960047   
6037        6037           23139           0      20.888243   
5832        5832           18283           0      20.840299   
1368        1368           10873           0      19.925364   
1648        1648           30554           0      19.879081   
5561        5561           18065           0      19.871112   
2633        2633            7471           1      19.746952   
1015        1015            4488           0      19.675014   
617          617             489           0      19.514402   
4760        4760           22420           0      19.359912   
5912        5912           24321           0      19.087191   
1918        1918            9499           0      18.849843   
1474        1474           20500           0      18.753695   
2408        2408            8430           1      18.715166   
5634        5634           29099           0      18.301478   
2063        2063           30050           0      18.262359   
3237        3237           14636           0      18.230733   
1041        1041            6582           0      18.135534   
2185        2185            4281           0      17.813882   
2069        2069            5424           0      17.736516   
723          723           22463           0      17.613211   
3617        3617            2823           0      17.555224   
4195        4195            7215           0      17.548258   
4136        4136            1621           0      17.494773   
5508        5508           19398           0      17.462141   
4495        4495           27757           0      17.385048   
2698        2698           24569           0      16.987629   
318          318           15485           0      16.843722   
5764        5764           19109           0      16.654100   
206          206           19402           0      16.533492   
568          568           21630           1      16.487178   
5104        5104           11353           0      16.411282   
4424        4424           12444           0      16.337279   
3222        3222           20121           0      16.293388   
583          583           11181           0      16.246422   
2335        2335            3970           0      16.161165   
4657        4657             461           0      15.815400   
4042        4042           23668           0      15.766128   
4822        4822            3297           0      15.670455   
6090        6090           10569           0      15.489787   
4457        4457           19745           0      15.461162   
4802        4802           24981           0      15.412062   
5307        5307           22858           0      15.409822   
3868        3868           29840           0      15.201545   
5869        5869            5388           0      15.102858   
4443        4443            4220           0      14.788224   
5058        5058            2886           0      14.649622   
1884        1884            2343           0      14.615171   
3331        3331           21306           0      14.558748   
4727        4727           19440           0      14.555680   
4181        4181           27164           0      14.444393   
911          911           22752           0      14.391877   
2310        2310           10271           0      14.380154   
5340        5340            8372           0      14.308365   
2743        2743           16836           0      14.270040   
5232        5232           10635           0      14.231229   
441          441            4725           0      14.225659   
5126        5126            4723           0      14.178734   
4117        4117           26217           0      13.952058   
2474        2474           24820           0      13.935751   
4000        4000           21742           1      13.876690   
3857        3857           21138           0      13.804780   
4041        4041             414           0      13.790550   
3761        3761           17585           0      13.768589   
5472        5472           23223           0      13.658282   
4344        4344           16590           0      13.604153   
1850        1850           20991           0      13.595720   
5723        5723           21605           0      13.569790   
6095        6095           10266           0      13.567085   
3584        3584           18151           0      13.556563   
4968        4968           29809           0      13.517319   
4121        4121           23059           0      13.436850   
5238        5238           28386           0      13.367396   
4912        4912           11415           0      13.366269   
2458        2458           24937           0      13.349794   
5722        5722            2389           0      13.309392   
3485        3485            2052           0      13.291707   
3480        3480           22872           0      13.253052   
1370        1370            2646           0      13.228744   
3486        3486           22102           0      13.138209   
3924        3924           25201           0      13.108866   
2603        2603           21767           0      13.076266   
4318        4318           18846           0      13.069648   
2598        2598           26685           0      13.040177   
5315        5315           11909           0      13.033870   
3173        3173           13150           0      13.010712   
3313        3313            4771           0      12.919100   
3762        3762           25477           0      12.891405   
6101        6101           23400           0      12.888135   
3228        3228           26392           0      12.825623   
5993        5993           30196           0      12.817350   
5317        5317            6869           0      12.809163   
4725        4725           24731           0      12.806274   
3719        3719           26680           0      12.791581   
3034        3034            7396           0      12.783502   
3042        3042            6448           0      12.776960   
2712        2712           19218           0      12.735611   
5621        5621           15119           0      12.698528   
3057        3057            7048           0      12.572986   
5488        5488           26818           0      12.512614   
5318        5318           26756           0      12.432364   
3859        3859             272           0      12.426248   
5864        5864           18379           0      12.396165   
906          906           30176           0      12.363773   
2769        2769           12008           0      12.328313   
4750        4750            1132           0      12.300127   
4448        4448           13859           0      12.298924   
683          683           28078           0      12.250026   
5355        5355           28960           0      12.159105   
1292        1292           12974           0      12.158200   
3358        3358           20099           0      12.120979   
5579        5579            8798           0      12.115565   
4109        4109            9567           0      12.077118   
2614        2614            7778           0      11.986381   
5469        5469           19142           0      11.952735   
734          734           25942           0      11.931480   
4605        4605           11057           0      11.928982   
2436        2436           30637           0      11.857144   
1489        1489           16304           0      11.848568   
5039        5039           15973           0      11.848305   
5572        5572            8007           0      11.835153   
5559        5559           14784           0      11.807927   
5585        5585            8119           0      11.781050   
6098        6098           30435           0      11.723671   
2151        2151           16990           0      11.718815   
5583        5583           28206           0      11.704253   
4285        4285            3775           0      11.690815   
5848        5848           29914           0      11.679230   
4133        4133           12498           0      11.595425   
5443        5443            1933           0      11.583689   
5182        5182           10678           0      11.570579   
5830        5830            8060           0      11.567113   
5021        5021            7553           0      11.536473   
2855        2855           24309           0      11.496790   
5838        5838           16337           0      11.495425   
2568        2568           25972           0      11.492360   
5829        5829            4611           0      11.486948   
4762        4762           13771           0      11.470868   
3585        3585           24237           0      11.469049   
2934        2934            2180           0      11.457347   
3578        3578           22997           0      11.435342   
2721        2721           12443           0      11.394953   
4777        4777            6778           0      11.383845   
4454        4454            2991           0      11.363441   
4751        4751           22641           0      11.312830   
2126        2126           24739           0      11.265108   
1179        1179           13130           0      11.242456   
5913        5913            1162           0      11.236356   
5825        5825           30705           0      11.226238   
1291        1291           22819           0      11.221342   
6094        6094           22854           0      11.211608   
1769        1769           15817           0      11.189852   
5188        5188            7880           0      11.097902   
3787        3787           27746           0      11.097583   
5064        5064            1912           0      11.080205   
5608        5608           27905           0      11.062675   
1317        1317           29024           0      11.047158   
5735        5735           18408           0      10.972714   
4791        4791           14309           0      10.961589   
5032        5032           23537           0      10.948659   
5804        5804           10680           0      10.948094   
6102        6102           11789           0      10.946614   
4927        4927           29100           0      10.939586   
4603        4603           29085           0      10.924157   
4322        4322            9477           0      10.907575   
5100        5100             355           0      10.896539   
2014        2014           21896           0      10.862438   
4438        4438           17336           0      10.853314   
3925        3925           25293           0      10.850252   
3563        3563           17812           0      10.836652   
2280        2280            3876           0      10.836282   
2148        2148            3837           0      10.831990   
1935        1935           18649           0      10.819508   
3438        3438           20424           0      10.796512   
5048        5048             282           0      10.765487   
6100        6100           26450           0      10.747065   
3999        3999            3473           0      10.732728   
5511        5511           19208           0      10.727679   
2717        2717            2898           0      10.721576   
3575        3575            6837           0      10.713618   
1618        1618            5169           0      10.670650   
3566        3566           29987           0      10.631155   
2271        2271             364           0      10.618999   
2009        2009            8040           0      10.616168   
4007        4007            6551           0      10.604847   
2984        2984            2872           0      10.604817   
2875        2875            6158           0      10.578699   
5221        5221           12155           0      10.577004   
5598        5598           13912           0      10.565491   
5724        5724           19905           0      10.562499   
4444        4444            8635           0      10.540827   
3324        3324            8063           0      10.535432   
3583        3583            1855           0      10.535415   
3738        3738           18285           0      10.482785   
3500        3500           24307           0      10.481469   
1776        1776            7217           0      10.478102   
5570        5570           22983           0      10.473474   
5060        5060            1370           0      10.472187   
4135        4135           15671           0      10.468990   
1531        1531            8540           0      10.398964   
2311        2311           29748           0      10.393793   
5050        5050           11189           0      10.386917   
1286        1286           26531           0      10.384874   
5868        5868            6447           0      10.371844   
5969        5969             311           0      10.363843   
52            52            7694           0      10.361153   
2114        2114            4640           0      10.339724   
5043        5043           14686           0      10.313564   
2887        2887           21146           0      10.299271   
6096        6096           11976           0      10.282293   
5571        5571             271           0      10.264286   
5873        5873           23261           0      10.251515   
4157        4157             561           0      10.249708   
1733        1733           18221           0      10.223281   
1862        1862           18605           0      10.214909   
3233        3233            1181           0      10.195861   
1761        1761           11933           0      10.183135   
3492        3492            4772           0      10.163175   
1675        1675            7920           0      10.144175   
5305        5305           22907           0      10.138560   
2042        2042             497           0      10.099823   
3004        3004             760           0      10.080808   
3171        3171            3879           0      10.072151   
3595        3595           11538           0      10.054336   
2985        2985            2454           0      10.026661   
3581        3581           27501           0      10.023069   
3968        3968             733           1      10.004719   
2405        2405           10881           0       9.973634   
4408        4408           12768           0       9.971103   
2417        2417           18751           0       9.969196   
5655        5655           18648           0       9.968372   
4516        4516           24627           0       9.965731   
4149        4149           17260           0       9.965122   
2428        2428           22940           0       9.942398   
5316        5316           24220           0       9.928829   
2010        2010            7997           0       9.918782   
2275        2275           21732           0       9.916198   
5558        5558            3383           0       9.914213   
6084        6084           15172           0       9.902782   
4743        4743           15532           0       9.887238   
2411        2411           25206           0       9.886163   
1297        1297           19576           0       9.885628   
3029        3029            3883           0       9.876323   
5566        5566           19806           0       9.871996   
5563        5563           16085           0       9.868267   
3858        3858           20631           0       9.856598   
3565        3565           29229           0       9.821516   
5303        5303            5458           0       9.815975   
2713        2713            6630           0       9.799921   
3557        3557            8640           0       9.784651   
1731        1731            5998           0       9.767011   
4748        4748            8392           0       9.762617   
856          856           18297           0       9.748383   
5715        5715           24273           0       9.744645   
5156        5156            9980           0       9.741808   
4507        4507           18070           0       9.730223   
4433        4433           30885           0       9.722395   
5560        5560           10408           0       9.719676   
4792        4792           24417           0       9.711913   
3317        3317            2308           0       9.710690   
2138        2138           28788           0       9.708437   
2754        2754           23370           0       9.702320   
3588        3588           29632           0       9.701643   
419          419            9173           0       9.697030   
2141        2141           10193           0       9.689874   
2995        2995           12094           0       9.686609   
1009        1009            5143           0       9.678918   
4737        4737            2192           0       9.645331   
4056        4056           30122           0       9.639697   
5289        5289           21600           0       9.639295   
5226        5226           19017           0       9.637657   
1042        1042           22118           0       9.636039   
669          669            4602           0       9.619178   
5866        5866           14551           0       9.612433   
1019        1019           11332           0       9.607080   
3847        3847           12271           0       9.601378   
2578        2578            2790           0       9.600256   
5865        5865            8088           0       9.588763   
4413        4413              84           0       9.580322   
5564        5564            5869           0       9.577275   
426          426           11693           0       9.576400   
3337        3337           24878           0       9.574023   
5300        5300           11131           0       9.561447   
5037        5037           16446           0       9.547809   
4911        4911            5287           0       9.544682   
3560        3560           10620           0       9.536772   
4430        4430            5180           0       9.516317   
4671        4671            4265           0       9.511412   
1283        1283           19412           0       9.503830   
3310        3310           29868           0       9.483703   
4423        4423           25791           0       9.478315   
4742        4742           16129           0       9.476799   
3320        3320            9100           0       9.470701   
3053        3053           25143           0       9.469077   
3319        3319           15568           0       9.460486   
721          721           12812           0       9.452333   
5308        5308           11190           0       9.442764   
4726        4726           27086           0       9.438185   
5464        5464           27532           0       9.437662   
2136        2136           16713           0       9.437338   
4729        4729            9900           0       9.429668   
1847        1847            7989           0       9.429247   
3911        3911            6995           0       9.420848   
4732        4732           22253           0       9.416369   
5565        5565            6595           0       9.402499   
6013        6013            3555           0       9.398702   
2170        2170           19503           0       9.385221   
3321        3321           30136           0       9.374887   
5460        5460            2428           0       9.366515   
4740        4740           17633           0       9.349274   
5183        5183           24797           0       9.342183   
5384        5384            7320           0       9.341870   
5298        5298            8123           0       9.340422   
1006        1006           30429           0       9.338324   
4447        4447           15379           0       9.334764   
1007        1007           28569           0       9.334530   
2994        2994           16266           0       9.332225   
5562        5562           24544           0       9.328428   
4230        4230            3351           0       9.327252   
4744        4744           10595           0       9.316586   
1887        1887           23384           0       9.306017   
4746        4746            3826           0       9.305956   
4432        4432           16430           0       9.304136   
5287        5287            3545           0       9.301447   
5288        5288            6667           0       9.301126   
916          916           21609           0       9.286189   
4116        4116           11639           0       9.285913   
3305        3305           17638           0       9.279977   
4418        4418           20001           0       9.275228   
4412        4412           17745           0       9.274664   
1609        1609             869           0       9.270151   
3850        3850             913           0       9.266780   
5292        5292           15080           0       9.265063   
4419        4419           23267           0       9.264732   
6087        6087            9494           0       9.264332   
3855        3855           28372           0       9.262695   
3299        3299           27814           0       9.262610   
5310        5310            2291           0       9.253497   
4728        4728           25483           0       9.253118   
5304        5304           18668           0       9.252537   
4415        4415           10238           0       9.252230   
2715        2715           21897           0       9.238340   
3002        3002           23017           0       9.233259   
5331        5331           28621           0       9.226167   
5044        5044            1114           0       9.215261   
4718        4718           14112           0       9.211751   
413          413           12381           0       9.203925   
4422        4422           19911           0       9.197866   
5902        5902           16305           0       9.196426   
5302        5302            8897           0       9.177450   
3291        3291           25785           0       9.173883   
5487        5487           26291           0       9.173479   
3145        3145           11498           0       9.162586   
5036        5036           13474           0       9.150072   
3848        3848            7378           0       9.139556   
4741        4741            2042           0       9.131256   
2579        2579           10769           0       9.119508   
5309        5309           12386           0       9.116674   
1600        1600           12632           0       9.115297   
144          144             659           0       9.105793   
5285        5285           12142           0       9.104923   
5301        5301           28225           0       9.097681   
1582        1582           14698           0       9.097084   
1579        1579            5575           0       9.092495   
4956        4956            9443           0       9.088506   
5311        5311            5324           0       9.087990   
5314        5314           22309           0       9.087655   
4108        4108           21380           0       9.087151   
6097        6097           25693           0       9.084861   
5569        5569           29534           0       9.083991   
5290        5290           26041           0       9.081094   
697          697           28356           0       9.077081   
3306        3306           30202           0       9.076050   
5438        5438           26178           0       9.070957   
4739        4739            6097           0       9.064578   
2407        2407           25541           0       9.059699   

      predicted_anomaly  \
4983                  1   
930                   1   
5776                  1   
4143                  1   
4021                  1   
4656                  1   
6043                  1   
5758                  1   
6091                  1   
5919                  1   
3763                  1   
5306                  1   
5206                  1   
5491                  1   
1788                  1   
2891                  1   
4358                  1   
5241                  1   
4955                  1   
1214                  1   
3886                  1   
4325                  1   
2885                  1   
4641                  1   
5757                  1   
6037                  1   
5832                  1   
1368                  1   
1648                  1   
5561                  1   
2633                  1   
1015                  0   
617                   0   
4760                  0   
5912                  0   
1918                  0   
1474                  0   
2408                  0   
5634                  0   
2063                  0   
3237                  0   
1041                  0   
2185                  0   
2069                  0   
723                   0   
3617                  0   
4195                  0   
4136                  0   
5508                  0   
4495                  0   
2698                  0   
318                   0   
5764                  0   
206                   0   
568                   0   
5104                  0   
4424                  0   
3222                  0   
583                   0   
2335                  0   
4657                  0   
4042                  0   
4822                  0   
6090                  0   
4457                  0   
4802                  0   
5307                  0   
3868                  0   
5869                  0   
4443                  0   
5058                  0   
1884                  0   
3331                  0   
4727                  0   
4181                  0   
911                   0   
2310                  0   
5340                  0   
2743                  0   
5232                  0   
441                   0   
5126                  0   
4117                  0   
2474                  0   
4000                  0   
3857                  0   
4041                  0   
3761                  0   
5472                  0   
4344                  0   
1850                  0   
5723                  0   
6095                  0   
3584                  0   
4968                  0   
4121                  0   
5238                  0   
4912                  0   
2458                  0   
5722                  0   
3485                  0   
3480                  0   
1370                  0   
3486                  0   
3924                  0   
2603                  0   
4318                  0   
2598                  0   
5315                  0   
3173                  0   
3313                  0   
3762                  0   
6101                  0   
3228                  0   
5993                  0   
5317                  0   
4725                  0   
3719                  0   
3034                  0   
3042                  0   
2712                  0   
5621                  0   
3057                  0   
5488                  0   
5318                  0   
3859                  0   
5864                  0   
906                   0   
2769                  0   
4750                  0   
4448                  0   
683                   0   
5355                  0   
1292                  0   
3358                  0   
5579                  0   
4109                  0   
2614                  0   
5469                  0   
734                   0   
4605                  0   
2436                  0   
1489                  0   
5039                  0   
5572                  0   
5559                  0   
5585                  0   
6098                  0   
2151                  0   
5583                  0   
4285                  0   
5848                  0   
4133                  0   
5443                  0   
5182                  0   
5830                  0   
5021                  0   
2855                  0   
5838                  0   
2568                  0   
5829                  0   
4762                  0   
3585                  0   
2934                  0   
3578                  0   
2721                  0   
4777                  0   
4454                  0   
4751                  0   
2126                  0   
1179                  0   
5913                  0   
5825                  0   
1291                  0   
6094                  0   
1769                  0   
5188                  0   
3787                  0   
5064                  0   
5608                  0   
1317                  0   
5735                  0   
4791                  0   
5032                  0   
5804                  0   
6102                  0   
4927                  0   
4603                  0   
4322                  0   
5100                  0   
2014                  0   
4438                  0   
3925                  0   
3563                  0   
2280                  0   
2148                  0   
1935                  0   
3438                  0   
5048                  0   
6100                  0   
3999                  0   
5511                  0   
2717                  0   
3575                  0   
1618                  0   
3566                  0   
2271                  0   
2009                  0   
4007                  0   
2984                  0   
2875                  0   
5221                  0   
5598                  0   
5724                  0   
4444                  0   
3324                  0   
3583                  0   
3738                  0   
3500                  0   
1776                  0   
5570                  0   
5060                  0   
4135                  0   
1531                  0   
2311                  0   
5050                  0   
1286                  0   
5868                  0   
5969                  0   
52                    0   
2114                  0   
5043                  0   
2887                  0   
6096                  0   
5571                  0   
5873                  0   
4157                  0   
1733                  0   
1862                  0   
3233                  0   
1761                  0   
3492                  0   
1675                  0   
5305                  0   
2042                  0   
3004                  0   
3171                  0   
3595                  0   
2985                  0   
3581                  0   
3968                  0   
2405                  0   
4408                  0   
2417                  0   
5655                  0   
4516                  0   
4149                  0   
2428                  0   
5316                  0   
2010                  0   
2275                  0   
5558                  0   
6084                  0   
4743                  0   
2411                  0   
1297                  0   
3029                  0   
5566                  0   
5563                  0   
3858                  0   
3565                  0   
5303                  0   
2713                  0   
3557                  0   
1731                  0   
4748                  0   
856                   0   
5715                  0   
5156                  0   
4507                  0   
4433                  0   
5560                  0   
4792                  0   
3317                  0   
2138                  0   
2754                  0   
3588                  0   
419                   0   
2141                  0   
2995                  0   
1009                  0   
4737                  0   
4056                  0   
5289                  0   
5226                  0   
1042                  0   
669                   0   
5866                  0   
1019                  0   
3847                  0   
2578                  0   
5865                  0   
4413                  0   
5564                  0   
426                   0   
3337                  0   
5300                  0   
5037                  0   
4911                  0   
3560                  0   
4430                  0   
4671                  0   
1283                  0   
3310                  0   
4423                  0   
4742                  0   
3320                  0   
3053                  0   
3319                  0   
721                   0   
5308                  0   
4726                  0   
5464                  0   
2136                  0   
4729                  0   
1847                  0   
3911                  0   
4732                  0   
5565                  0   
6013                  0   
2170                  0   
3321                  0   
5460                  0   
4740                  0   
5183                  0   
5384                  0   
5298                  0   
1006                  0   
4447                  0   
1007                  0   
2994                  0   
5562                  0   
4230                  0   
4744                  0   
1887                  0   
4746                  0   
4432                  0   
5287                  0   
5288                  0   
916                   0   
4116                  0   
3305                  0   
4418                  0   
4412                  0   
1609                  0   
3850                  0   
5292                  0   
4419                  0   
6087                  0   
3855                  0   
3299                  0   
5310                  0   
4728                  0   
5304                  0   
4415                  0   
2715                  0   
3002                  0   
5331                  0   
5044                  0   
4718                  0   
413                   0   
4422                  0   
5902                  0   
5302                  0   
3291                  0   
5487                  0   
3145                  0   
5036                  0   
3848                  0   
4741                  0   
2579                  0   
5309                  0   
1600                  0   
144                   0   
5285                  0   
5301                  0   
1582                  0   
1579                  0   
4956                  0   
5311                  0   
5314                  0   
4108                  0   
6097                  0   
5569                  0   
5290                  0   
697                   0   
3306                  0   
5438                  0   
4739                  0   
2407                  0   

                                                                             anomaly_description  
4983                                                                                         NaN  
930       SUBTLE_PAYEE_MISMATCH: Payee changed from 'Jones PLC Solutions' to 'Jones PLC Systems'  
5776                                                                                         NaN  
4143  SUBTLE_PAYEE_MISMATCH: Payee changed from 'Ramirez PLC Solutions' to 'Ramirez PLC Systems'  
4021                                                                                         NaN  
4656                                                                                         NaN  
6043                                                                                         NaN  
5758                                                 AMOUNT_ANOMALY: Amount changed from ~708309  
6091                                                                                         NaN  
5919                                                                                         NaN  
3763                                                                                         NaN  
5306                                                                                         NaN  
5206                                                                                         NaN  
5491                                                                                         NaN  
1788                                                                                         NaN  
2891                                                                                         NaN  
4358                                                                                         NaN  
5241                                                                                         NaN  
4955                                                                                         NaN  
1214                                                                                         NaN  
3886                                                                                         NaN  
4325                                                                                         NaN  
2885                                                                                         NaN  
4641                                                                                         NaN  
5757                     IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB35VJGS13...  
6037                                                                                         NaN  
5832                                                                                         NaN  
1368                                                                                         NaN  
1648                                                                                         NaN  
5561                                                                                         NaN  
2633                     IBAN_MISMATCH_ANOMALY: IBAN changed from GB17PJMJ26... to GB80JWGI98...  
1015                                                                                         NaN  
617                                                                                          NaN  
4760                                                                                         NaN  
5912                                                                                         NaN  
1918                                                                                         NaN  
1474                                                                                         NaN  
2408                                 PAYEE_ANOMALY: Payee changed from Barton-Anderson Solutions  
5634                                                                                         NaN  
2063                                                                                         NaN  
3237                                                                                         NaN  
1041                                                                                         NaN  
2185                                                                                         NaN  
2069                                                                                         NaN  
723                                                                                          NaN  
3617                                                                                         NaN  
4195                                                                                         NaN  
4136                                                                                         NaN  
5508                                                                                         NaN  
4495                                                                                         NaN  
2698                                                                                         NaN  
318                                                                                          NaN  
5764                                                                                         NaN  
206                                                                                          NaN  
568                         CHANNEL_ANOMALY: Payment made via CARD/MOBILE_APP instead of ACH/API  
5104                                                                                         NaN  
4424                                                                                         NaN  
3222                                                                                         NaN  
583                                                                                          NaN  
2335                                                                                         NaN  
4657                                                                                         NaN  
4042                                                                                         NaN  
4822                                                                                         NaN  
6090                                                                                         NaN  
4457                                                                                         NaN  
4802                                                                                         NaN  
5307                                                                                         NaN  
3868                                                                                         NaN  
5869                                                                                         NaN  
4443                                                                                         NaN  
5058                                                                                         NaN  
1884                                                                                         NaN  
3331                                                                                         NaN  
4727                                                                                         NaN  
4181                                                                                         NaN  
911                                                                                          NaN  
2310                                                                                         NaN  
5340                                                                                         NaN  
2743                                                                                         NaN  
5232                                                                                         NaN  
441                                                                                          NaN  
5126                                                                                         NaN  
4117                                                                                         NaN  
2474                                                                                         NaN  
4000                                                FREQUENCY_ANOMALY: Duplicate monthly payment  
3857                                                                                         NaN  
4041                                                                                         NaN  
3761                                                                                         NaN  
5472                                                                                         NaN  
4344                                                                                         NaN  
1850                                                                                         NaN  
5723                                                                                         NaN  
6095                                                                                         NaN  
3584                                                                                         NaN  
4968                                                                                         NaN  
4121                                                                                         NaN  
5238                                                                                         NaN  
4912                                                                                         NaN  
2458                                                                                         NaN  
5722                                                                                         NaN  
3485                                                                                         NaN  
3480                                                                                         NaN  
1370                                                                                         NaN  
3486                                                                                         NaN  
3924                                                                                         NaN  
2603                                                                                         NaN  
4318                                                                                         NaN  
2598                                                                                         NaN  
5315                                                                                         NaN  
3173                                                                                         NaN  
3313                                                                                         NaN  
3762                                                                                         NaN  
6101                                                                                         NaN  
3228                                                                                         NaN  
5993                                                                                         NaN  
5317                                                                                         NaN  
4725                                                                                         NaN  
3719                                                                                         NaN  
3034                                                                                         NaN  
3042                                                                                         NaN  
2712                                                                                         NaN  
5621                                                                                         NaN  
3057                                                                                         NaN  
5488                                                                                         NaN  
5318                                                                                         NaN  
3859                                                                                         NaN  
5864                                                                                         NaN  
906                                                                                          NaN  
2769                                                                                         NaN  
4750                                                                                         NaN  
4448                                                                                         NaN  
683                                                                                          NaN  
5355                                                                                         NaN  
1292                                                                                         NaN  
3358                                                                                         NaN  
5579                                                                                         NaN  
4109                                                                                         NaN  
2614                                                                                         NaN  
5469                                                                                         NaN  
734                                                                                          NaN  
4605                                                                                         NaN  
2436                                                                                         NaN  
1489                                                                                         NaN  
5039                                                                                         NaN  
5572                                                                                         NaN  
5559                                                                                         NaN  
5585                                                                                         NaN  
6098                                                                                         NaN  
2151                                                                                         NaN  
5583                                                                                         NaN  
4285                                                                                         NaN  
5848                                                                                         NaN  
4133                                                                                         NaN  
5443                                                                                         NaN  
5182                                                                                         NaN  
5830                                                                                         NaN  
5021                                                                                         NaN  
2855                                                                                         NaN  
5838                                                                                         NaN  
2568                                                                                         NaN  
5829                                                                                         NaN  
4762                                                                                         NaN  
3585                                                                                         NaN  
2934                                                                                         NaN  
3578                                                                                         NaN  
2721                                                                                         NaN  
4777                                                                                         NaN  
4454                                                                                         NaN  
4751                                                                                         NaN  
2126                                                                                         NaN  
1179                                                                                         NaN  
5913                                                                                         NaN  
5825                                                                                         NaN  
1291                                                                                         NaN  
6094                                                                                         NaN  
1769                                                                                         NaN  
5188                                                                                         NaN  
3787                                                                                         NaN  
5064                                                                                         NaN  
5608                                                                                         NaN  
1317                                                                                         NaN  
5735                                                                                         NaN  
4791                                                                                         NaN  
5032                                                                                         NaN  
5804                                                                                         NaN  
6102                                                                                         NaN  
4927                                                                                         NaN  
4603                                                                                         NaN  
4322                                                                                         NaN  
5100                                                                                         NaN  
2014                                                                                         NaN  
4438                                                                                         NaN  
3925                                                                                         NaN  
3563                                                                                         NaN  
2280                                                                                         NaN  
2148                                                                                         NaN  
1935                                                                                         NaN  
3438                                                                                         NaN  
5048                                                                                         NaN  
6100                                                                                         NaN  
3999                                                                                         NaN  
5511                                                                                         NaN  
2717                                                                                         NaN  
3575                                                                                         NaN  
1618                                                                                         NaN  
3566                                                                                         NaN  
2271                                                                                         NaN  
2009                                                                                         NaN  
4007                                                                                         NaN  
2984                                                                                         NaN  
2875                                                                                         NaN  
5221                                                                                         NaN  
5598                                                                                         NaN  
5724                                                                                         NaN  
4444                                                                                         NaN  
3324                                                                                         NaN  
3583                                                                                         NaN  
3738                                                                                         NaN  
3500                                                                                         NaN  
1776                                                                                         NaN  
5570                                                                                         NaN  
5060                                                                                         NaN  
4135                                                                                         NaN  
1531                                                                                         NaN  
2311                                                                                         NaN  
5050                                                                                         NaN  
1286                                                                                         NaN  
5868                                                                                         NaN  
5969                                                                                         NaN  
52                                                                                           NaN  
2114                                                                                         NaN  
5043                                                                                         NaN  
2887                                                                                         NaN  
6096                                                                                         NaN  
5571                                                                                         NaN  
5873                                                                                         NaN  
4157                                                                                         NaN  
1733                                                                                         NaN  
1862                                                                                         NaN  
3233                                                                                         NaN  
1761                                                                                         NaN  
3492                                                                                         NaN  
1675                                                                                         NaN  
5305                                                                                         NaN  
2042                                                                                         NaN  
3004                                                                                         NaN  
3171                                                                                         NaN  
3595                                                                                         NaN  
2985                                                                                         NaN  
3581                                                                                         NaN  
3968                                                FREQUENCY_ANOMALY: Duplicate monthly payment  
2405                                                                                         NaN  
4408                                                                                         NaN  
2417                                                                                         NaN  
5655                                                                                         NaN  
4516                                                                                         NaN  
4149                                                                                         NaN  
2428                                                                                         NaN  
5316                                                                                         NaN  
2010                                                                                         NaN  
2275                                                                                         NaN  
5558                                                                                         NaN  
6084                                                                                         NaN  
4743                                                                                         NaN  
2411                                                                                         NaN  
1297                                                                                         NaN  
3029                                                                                         NaN  
5566                                                                                         NaN  
5563                                                                                         NaN  
3858                                                                                         NaN  
3565                                                                                         NaN  
5303                                                                                         NaN  
2713                                                                                         NaN  
3557                                                                                         NaN  
1731                                                                                         NaN  
4748                                                                                         NaN  
856                                                                                          NaN  
5715                                                                                         NaN  
5156                                                                                         NaN  
4507                                                                                         NaN  
4433                                                                                         NaN  
5560                                                                                         NaN  
4792                                                                                         NaN  
3317                                                                                         NaN  
2138                                                                                         NaN  
2754                                                                                         NaN  
3588                                                                                         NaN  
419                                                                                          NaN  
2141                                                                                         NaN  
2995                                                                                         NaN  
1009                                                                                         NaN  
4737                                                                                         NaN  
4056                                                                                         NaN  
5289                                                                                         NaN  
5226                                                                                         NaN  
1042                                                                                         NaN  
669                                                                                          NaN  
5866                                                                                         NaN  
1019                                                                                         NaN  
3847                                                                                         NaN  
2578                                                                                         NaN  
5865                                                                                         NaN  
4413                                                                                         NaN  
5564                                                                                         NaN  
426                                                                                          NaN  
3337                                                                                         NaN  
5300                                                                                         NaN  
5037                                                                                         NaN  
4911                                                                                         NaN  
3560                                                                                         NaN  
4430                                                                                         NaN  
4671                                                                                         NaN  
1283                                                                                         NaN  
3310                                                                                         NaN  
4423                                                                                         NaN  
4742                                                                                         NaN  
3320                                                                                         NaN  
3053                                                                                         NaN  
3319                                                                                         NaN  
721                                                                                          NaN  
5308                                                                                         NaN  
4726                                                                                         NaN  
5464                                                                                         NaN  
2136                                                                                         NaN  
4729                                                                                         NaN  
1847                                                                                         NaN  
3911                                                                                         NaN  
4732                                                                                         NaN  
5565                                                                                         NaN  
6013                                                                                         NaN  
2170                                                                                         NaN  
3321                                                                                         NaN  
5460                                                                                         NaN  
4740                                                                                         NaN  
5183                                                                                         NaN  
5384                                                                                         NaN  
5298                                                                                         NaN  
1006                                                                                         NaN  
4447                                                                                         NaN  
1007                                                                                         NaN  
2994                                                                                         NaN  
5562                                                                                         NaN  
4230                                                                                         NaN  
4744                                                                                         NaN  
1887                                                                                         NaN  
4746                                                                                         NaN  
4432                                                                                         NaN  
5287                                                                                         NaN  
5288                                                                                         NaN  
916                                                                                          NaN  
4116                                                                                         NaN  
3305                                                                                         NaN  
4418                                                                                         NaN  
4412                                                                                         NaN  
1609                                                                                         NaN  
3850                                                                                         NaN  
5292                                                                                         NaN  
4419                                                                                         NaN  
6087                                                                                         NaN  
3855                                                                                         NaN  
3299                                                                                         NaN  
5310                                                                                         NaN  
4728                                                                                         NaN  
5304                                                                                         NaN  
4415                                                                                         NaN  
2715                                                                                         NaN  
3002                                                                                         NaN  
5331                                                                                         NaN  
5044                                                                                         NaN  
4718                                                                                         NaN  
413                                                                                          NaN  
4422                                                                                         NaN  
5902                                                                                         NaN  
5302                                                                                         NaN  
3291                                                                                         NaN  
5487                                                                                         NaN  
3145                                                                                         NaN  
5036                                                                                         NaN  
3848                                                                                         NaN  
4741                                                                                         NaN  
2579                                                                                         NaN  
5309                                                                                         NaN  
1600                                                                                         NaN  
144                                                                                          NaN  
5285                                                                                         NaN  
5301                                                                                         NaN  
1582                                                                                         NaN  
1579                                                                                         NaN  
4956                                                                                         NaN  
5311                                                                                         NaN  
5314                                                                                         NaN  
4108                                                                                         NaN  
6097                                                                                         NaN  
5569                                                                                         NaN  
5290                                                                                         NaN  
697                                                                                          NaN  
3306                                                                                         NaN  
5438                                                                                         NaN  
4739                                                                                         NaN  
2407                                                                                         NaN  

✓ Results saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_scores.csv
✓ Summary saved to: /pfs/work9/workspace/scratch/ma_pkonz-thesis/ForestDiffusion/results/business_anomaly_detection/business_anomaly_summary.json

================================================================================
BUSINESS ANOMALY DETECTION EXPERIMENT COMPLETED!
================================================================================
ROC-AUC: 0.9415
Best F1: 0.2381
Normal correctly classified: 6152/6178
Anomalies detected         : 5/11
== Job abgeschlossen ==
